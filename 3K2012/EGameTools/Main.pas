unit Main;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, Login,   ComCtrls,Printers,
  Grids, DBGrids, StdCtrls,  ExtCtrls, DBCtrls,
  bsSkinData, BusinessSkinForm, bsSkinTabs, bsSkinGrids, bsDBGrids,
  bsSkinCtrls, bsSkinBoxCtrls, bsdbctrls, Mask, DBTables, DB, bsMessages,DM,Inifiles,
  RzLabel, DBGridEh, Buttons, bsSkinShellCtrls, Menus, bsSkinMenus,
  RzPrgres, RzEdit, PrnDbgeh,  bsColorCtrls, FFPBox,mywil, bsDialogs,ADODB,
  GridsEh;

type
  TFrmMain = class(TForm)
    bsBusinessSkinForm1: TbsBusinessSkinForm;
    bsSkinData1: TbsSkinData;
    bsCompressedStoredSkin1: TbsCompressedStoredSkin;
    bsSkinMessage1: TbsSkinMessage;
    OpenDialog1: TbsSkinOpenDialog;
    SaveDialog1: TbsSkinSaveDialog;
    bsSkinPopupMenu3: TbsSkinPopupMenu;
    N5: TMenuItem;
    PrintDBGridEh1: TPrintDBGridEh;
    bsSkinPanel17: TbsSkinPanel;
    bsSkinStdLabel7: TbsSkinStdLabel;
    LabelProductName: TbsSkinStdLabel;
    bsSkinLinkLabel1: TbsSkinLinkLabel;
    bsSkinButtonLabel1: TbsSkinButtonLabel;
    bsSkinStdLabel17: TbsSkinStdLabel;
    LabelVersion: TbsSkinStdLabel;
    bsSkinPageControl1: TbsSkinPageControl;
    bsSkinTabSheet1: TbsSkinTabSheet;
    bsSkinPageControl2: TbsSkinPageControl;
    bsSkinTabSheet4: TbsSkinTabSheet;
    bsSkinSplitter1: TbsSkinSplitter;
    bsSkinPanel1: TbsSkinPanel;
    bsSkinStdLabel1: TbsSkinStdLabel;
    bsSkinStdLabel2: TbsSkinStdLabel;
    BtnMagicBaseBak: TbsSkinButton;
    BtnMagicBaseRestore: TbsSkinButton;
    bsSkinCheckRadioBox1: TbsSkinCheckRadioBox;
    bsSkinCheckRadioBox2: TbsSkinCheckRadioBox;
    bsSkinCheckRadioBox3: TbsSkinCheckRadioBox;
    EditMagName: TbsSkinEdit;
    bsSkinSpinEdit1: TbsSkinSpinEdit;
    BtnFindMagName: TbsSkinButton;
    BtnAlterMagicExp: TbsSkinButton;
    bsSkinButton12: TbsSkinButton;
    bsSkinButton15: TbsSkinButton;
    bsSkinDBNavigator1: TbsSkinDBNavigator;
    bsSkinExPanel1: TbsSkinExPanel;
    bsSkinMemo1: TbsSkinMemo;
    bsSkinPanel2: TbsSkinPanel;
    MagicDBGrid: TDBGridEh;
    bsSkinTabSheet5: TbsSkinTabSheet;
    bsSkinSplitter2: TbsSkinSplitter;
    bsSkinPanel3: TbsSkinPanel;
    bsSkinStdLabel3: TbsSkinStdLabel;
    BtnMobBaseBak: TbsSkinButton;
    BtnMobBaseRestore: TbsSkinButton;
    EditMobName: TbsSkinEdit;
    BtnFindMonName: TbsSkinButton;
    bsSkinButton11: TbsSkinButton;
    bsSkinButton14: TbsSkinButton;
    bsSkinDBNavigator2: TbsSkinDBNavigator;
    bsSkinExPanel2: TbsSkinExPanel;
    bsSkinMemo2: TbsSkinMemo;
    bsSkinPanel4: TbsSkinPanel;
    MobDBGrid: TDBGridEh;
    bsSkinTabSheet6: TbsSkinTabSheet;
    bsSkinSplitter3: TbsSkinSplitter;
    bsSkinPanel5: TbsSkinPanel;
    bsSkinStdLabel5: TbsSkinStdLabel;
    BtnItemsBaseBak: TbsSkinButton;
    BtnItemsBaseRestore: TbsSkinButton;
    BtnFindItemName: TbsSkinButton;
    EditItemsName: TbsSkinEdit;
    bsSkinGroupBox1: TbsSkinGroupBox;
    bsSkinStdLabel4: TbsSkinStdLabel;
    ComboBoxFilterItemsMode: TbsSkinComboBox;
    bsSkinButton7: TbsSkinButton;
    bsSkinButton13: TbsSkinButton;
    bsSkinDBNavigator3: TbsSkinDBNavigator;
    bsSkinExPanel3: TbsSkinExPanel;
    bsSkinSplitter4: TbsSkinSplitter;
    MemoItemsHint: TbsSkinMemo;
    ListBoxItemsHint: TbsSkinListBox;
    bsSkinScrollBar4: TbsSkinScrollBar;
    bsSkinPanel6: TbsSkinPanel;
    bsSkinScrollBar5: TbsSkinScrollBar;
    ItemsDBGrid: TDBGridEh;
    bsSkinTabSheet2: TbsSkinTabSheet;
    bsSkinGroupBox2: TbsSkinGroupBox;
    RzLabel1: TRzLabel;
    bsSkinPanel7: TbsSkinPanel;
    TrackEditColor1: TbsSkinTrackEdit;
    TrackEditColor2: TbsSkinTrackEdit;
    bsSkinTabSheet3: TbsSkinTabSheet;
    bsSkinPanel8: TbsSkinPanel;
    bsSkinSplitter5: TbsSkinSplitter;
    bsSkinPanel9: TbsSkinPanel;
    bsSkinGroupBox3: TbsSkinGroupBox;
    bsSkinGroupBox4: TbsSkinGroupBox;
    checkboxTransparent: TbsSkinCheckRadioBox;
    CheckBoxjump: TbsSkinCheckRadioBox;
    CheckBoxzuobiao: TbsSkinCheckRadioBox;
    checkboxXY: TbsSkinCheckRadioBox;
    Rb50: TbsSkinCheckRadioBox;
    rb100: TbsSkinCheckRadioBox;
    rb200: TbsSkinCheckRadioBox;
    rb400: TbsSkinCheckRadioBox;
    rb800: TbsSkinCheckRadioBox;
    rbauto: TbsSkinCheckRadioBox;
    btnx: TbsSkinButton;
    btny: TbsSkinButton;
    bsSkinPanel10: TbsSkinPanel;
    bsSkinStdLabel6: TbsSkinStdLabel;
    Label3: TbsSkinStdLabel;
    Label2: TbsSkinStdLabel;
    Label7: TbsSkinStdLabel;
    btnup: TbsSkinButton;
    btndelete: TbsSkinButton;
    BtnAutoPlay: TbsSkinButton;
    btninput: TbsSkinButton;
    btnAdd: TbsSkinButton;
    btnallinput: TbsSkinButton;
    btndown: TbsSkinButton;
    BtnJump: TbsSkinButton;
    btnstop: TbsSkinButton;
    BtnOut: TbsSkinButton;
    btnCreate: TbsSkinButton;
    btnallOut: TbsSkinButton;
    bsSkinPanel11: TbsSkinPanel;
    bsSkinPanel12: TbsSkinPanel;
    bsSkinSplitter6: TbsSkinSplitter;
    DrawGrid1: TDrawGrid;
    Image1: TImage;
    ScrollBox1: TScrollBox;
    PaintBox1: TFlickerFreePaintBox;
    SavePictureDialog1: TbsSkinSavePictureDialog;
    OpenPictureDialog1: TbsSkinOpenPictureDialog;
    Labeltype: TbsSkinStdLabel;
    LabelSize: TbsSkinStdLabel;
    LabelIndex: TbsSkinStdLabel;
    LabelX: TbsSkinStdLabel;
    LabelY: TbsSkinStdLabel;
    InputDialog: TbsSkinInputDialog;
    Timer1: TTimer;
    EditFileName: TbsSkinFileEdit;
    bsSkinGroupBox5: TbsSkinGroupBox;
    bsSkinCheckRadioBox4: TbsSkinCheckRadioBox;
    bsSkinFileEdit1: TbsSkinFileEdit;
    bsSkinStdLabel8: TbsSkinStdLabel;
    bsSkinSelectDirectoryDialog1: TbsSkinSelectDirectoryDialog;
    bsSkinButton1: TbsSkinButton;
    LabelColorCount: TbsSkinStdLabel;
    bsSkinGroupBox6: TbsSkinGroupBox;
    bsSkinStdLabel9: TbsSkinStdLabel;
    bsSkinFileEdit2: TbsSkinFileEdit;
    bsSkinButton2: TbsSkinButton;
    bsSkinButton3: TbsSkinButton;
    bsSkinButton4: TbsSkinButton;
    bsSkinButton5: TbsSkinButton;
    bsSkinGroupBox7: TbsSkinGroupBox;
    bsSkinStdLabel10: TbsSkinStdLabel;
    bsSkinFileEdit3: TbsSkinFileEdit;
    bsSkinButton6: TbsSkinButton;
    bsSkinTabSheet7: TbsSkinTabSheet;
    bsSkinPanel13: TbsSkinPanel;
    bsSkinStdLabel11: TbsSkinStdLabel;
    BtnFongHaoBaseBak: TbsSkinButton;
    BtnFongHaoRestore: TbsSkinButton;
    bsSkinButton10: TbsSkinButton;
    bsSkinEdit1: TbsSkinEdit;
    bsSkinGroupBox8: TbsSkinGroupBox;
    bsSkinStdLabel12: TbsSkinStdLabel;
    ComboBoxFilterFongHaoMode: TbsSkinComboBox;
    bsSkinButton16: TbsSkinButton;
    bsSkinButton17: TbsSkinButton;
    bsSkinButton18: TbsSkinButton;
    bsSkinDBNavigator4: TbsSkinDBNavigator;
    bsSkinExPanel4: TbsSkinExPanel;
    bsSkinSplitter7: TbsSkinSplitter;
    MemoFongHaoHint: TbsSkinMemo;
    ListBoxFongHaoHint: TbsSkinListBox;
    bsSkinScrollBar1: TbsSkinScrollBar;
    bsSkinSplitter8: TbsSkinSplitter;
    FongHaoDBGrid: TDBGridEh;
    procedure BtnFindMagNameClick(Sender: TObject);
    procedure BtnFindMonNameClick(Sender: TObject);
    procedure BtnFindItemNameClick(Sender: TObject);
    procedure ComboBoxFilterItemsModeChange(Sender: TObject);
    procedure TrackEditColor1Change(Sender: TObject);
    procedure TrackEditColor2Change(Sender: TObject);
    procedure FormShow(Sender: TObject);
    procedure bsSkinButton7Click(Sender: TObject);
    procedure N5Click(Sender: TObject);
    procedure bsSkinButton12Click(Sender: TObject);
    procedure bsSkinButton11Click(Sender: TObject);
    procedure bsSkinButton15Click(Sender: TObject);
    procedure bsSkinButton14Click(Sender: TObject);
    procedure bsSkinButton13Click(Sender: TObject);
    procedure BtnMagicBaseBakClick(Sender: TObject);
    procedure BtnMagicBaseRestoreClick(Sender: TObject);
    procedure bsSkinButtonLabel1Click(Sender: TObject);
    procedure BtnAlterMagicExpClick(Sender: TObject);
    procedure FormCreate(Sender: TObject);
    procedure FormPaint(Sender: TObject);
    procedure PaintBox1Paint(Sender: TObject; Canvas: TCanvas);
    Function Extractrec(Restype,ResName,ResNewNAme:string):boolean;
    procedure FillInfo(index:Integer);
    procedure DrawGrid1DrawCell(Sender: TObject; ACol, ARow: Integer;
      Rect: TRect; State: TGridDrawState);
    procedure btnupClick(Sender: TObject);
    procedure btndownClick(Sender: TObject);
    procedure btnxClick(Sender: TObject);
    procedure btnyClick(Sender: TObject);
    procedure Rb50Click(Sender: TObject);
    procedure BtnJumpClick(Sender: TObject);
    procedure BtnAutoPlayClick(Sender: TObject);
    procedure btnstopClick(Sender: TObject);
    procedure btninputClick(Sender: TObject);
    procedure BtnOutClick(Sender: TObject);
    procedure btndeleteClick(Sender: TObject);
    procedure btnAddClick(Sender: TObject);
    procedure btnCreateClick(Sender: TObject);
    procedure btnallinputClick(Sender: TObject);
    procedure btnallOutClick(Sender: TObject);
    procedure Timer1Timer(Sender: TObject);
    procedure FormClose(Sender: TObject; var Action: TCloseAction);
    procedure FormDestroy(Sender: TObject);
    procedure EditFileNameButtonClick(Sender: TObject);
    procedure bsSkinFileEdit1ButtonClick(Sender: TObject);
    procedure bsSkinButton1Click(Sender: TObject);
    procedure bsSkinCheckRadioBox4Click(Sender: TObject);
    procedure bsSkinTabSheet2Show(Sender: TObject);
    procedure bsSkinButton2Click(Sender: TObject);
    procedure bsSkinFileEdit2ButtonClick(Sender: TObject);
    procedure bsSkinButton3Click(Sender: TObject);
    procedure bsSkinButton4Click(Sender: TObject);
    procedure bsSkinButton5Click(Sender: TObject);
    procedure bsSkinButton6Click(Sender: TObject);
    procedure bsSkinFileEdit3ButtonClick(Sender: TObject);
    procedure bsSkinButton16Click(Sender: TObject);
    procedure bsSkinButton18Click(Sender: TObject);
    procedure bsSkinButton17Click(Sender: TObject);
    procedure bsSkinButton10Click(Sender: TObject);
    procedure ComboBoxFilterFongHaoModeChange(Sender: TObject);
    procedure bsSkinTabSheet7Show(Sender: TObject);
  private
    Function ExportTxt(DBGridEh:TDBGrideh;Var TextName:string):BooLean;//µ¼³öTXT
    Function ExportTxt1(DBGridEh:TDBGrideh;Var TextName:string):BooLean;
    procedure BeforePrint();
  public
    procedure LoadConfig(); //¶ÁÈëÅäÖÃ
    procedure Open();
  end;

var
  FrmMain: TFrmMain;
  boDelDenyChr: Boolean;
  boSellOffItem: Boolean;
  boBigStorage: Boolean;
  Wil:TWil;
  Bmpx,bmpy: Integer;
  BmpIndex,BmpWidth,BmpHeight: Integer;
  BmpZoom: Real;
  BmpTran: Boolean;
  MainBitMap:TBitMap;
  Stop:Boolean;
  boIsSort: Boolean;//ÎïÆ·Êý¾Ý¿âÊÇ·ñÅÅÐò
implementation

uses EGameToolsShare,EDcodeUnit,AboutUnit, DelWil, AddOneWil, NewWil, AddWil,
  OutWil;

{$R *.dfm}

procedure TFrmMain.LoadConfig; //¶ÁÈëÅäÖÃ
var
  MyIni: TIniFile;
begin
  MyIni := TIniFile.Create(ConfigFileName);
  DBEName := MyIni.ReadString('SYSTEM','DBEName',DBEName);
  sGameDirectory := MyIni.ReadString('SYSTEM','ServerDir',sGameDirectory);
  sWilDirectory:= MyIni.ReadString('SYSTEM','WilDirectory',sWilDirectory);
  MyIni.Free;
end;

procedure TFrmMain.Open;
begin
  FrmDM.TableMagic.DatabaseName := DBEName;
  FrmDM.TableMagic.Active := True;
       MagicDBGrid.Columns[0].Title.Caption := 'ÐòºÅ';
       MagicDBGrid.Columns[1].Title.Caption := 'Ãû³Æ';
       MagicDBGrid.Columns[2].Title.Caption := '¶¯×÷Ð§¹û';
       MagicDBGrid.Columns[3].Title.Caption := 'Ä§·¨Ð§¹û';
       MagicDBGrid.Columns[4].Title.Caption := 'Ä§·¨ÏûºÄ';
       MagicDBGrid.Columns[5].Title.Caption := '»ù±¾ÍþÁ¦';
       MagicDBGrid.Columns[6].Title.Caption := '×î´óÍþÁ¦';
       MagicDBGrid.Columns[7].Title.Caption := 'Éý¼¶Ä§·¨';
       MagicDBGrid.Columns[8].Title.Caption := 'Éý¼¶ÍþÁ¦';
       MagicDBGrid.Columns[9].Title.Caption := 'Éý¼¶×î´óÍþÁ¦';
       MagicDBGrid.Columns[10].Title.Caption := 'Ö°Òµ';
       MagicDBGrid.Columns[11].Title.Caption := '1¼¶µÈ¼¶';
       MagicDBGrid.Columns[12].Title.Caption := '1¼¶¾­Ñé';
       MagicDBGrid.Columns[13].Title.Caption := '2¼¶µÈ¼¶';
       MagicDBGrid.Columns[14].Title.Caption := '2¼¶¾­Ñé';
       MagicDBGrid.Columns[15].Title.Caption := '3¼¶µÈ¼¶';
       MagicDBGrid.Columns[16].Title.Caption := '3¼¶¾­Ñé';
       MagicDBGrid.Columns[17].Title.Caption := '¼¼ÄÜÑÓÊ±';
       MagicDBGrid.Columns[18].Title.Caption := '±¸×¢ËµÃ÷';
  FrmDM.TableMonster.DatabaseName := DBEName;
  FrmDM.TableMonster.Active := True;
       MobDBGrid.Columns[0].Title.Caption := 'Ãû³Æ';
       MobDBGrid.Columns[1].Title.Caption := 'ÖÖ×å';
       MobDBGrid.Columns[2].Title.Caption := 'ÖÖ×åÍ¼Ïó';
       MobDBGrid.Columns[3].Title.Caption := 'ÐÎÏó´úÂë';
       MobDBGrid.Columns[4].Title.Caption := 'µÈ¼¶';
       MobDBGrid.Columns[5].Title.Caption := '²»ËÀÏµ';
       MobDBGrid.Columns[6].Title.Caption := 'ÊÓ¾õ·¶Î§';
       MobDBGrid.Columns[7].Title.Caption := '¾­ÑéÖµ';
       MobDBGrid.Columns[8].Title.Caption := 'ÉúÃüÖµ';
       MobDBGrid.Columns[9].Title.Caption := 'Ä§·¨Öµ';
       MobDBGrid.Columns[10].Title.Caption := '·ÀÓùÁ¦';
       MobDBGrid.Columns[11].Title.Caption := 'Ä§ÓùÁ¦';
       MobDBGrid.Columns[12].Title.Caption := '¹¥»÷Á¦';
       MobDBGrid.Columns[13].Title.Caption := '×î´ó¹¥»÷Á¦';
       MobDBGrid.Columns[14].Title.Caption := 'Ä§·¨Á¦';
       MobDBGrid.Columns[15].Title.Caption := 'µÀÊõÁ¦';
       MobDBGrid.Columns[16].Title.Caption := 'Ãô½Ý';
       MobDBGrid.Columns[17].Title.Caption := 'ÃüÖÐÂÊ';
       MobDBGrid.Columns[18].Title.Caption := 'ÐÐ×ßËÙ¶È';
       MobDBGrid.Columns[19].Title.Caption := 'ÐÐ×ß²½·¥';
       MobDBGrid.Columns[20].Title.Caption := 'ÐÐ×ßµÈ´ý';
       MobDBGrid.Columns[21].Title.Caption := '¹¥»÷ËÙ¶È';
  FrmDM.TableStdItems.DatabaseName := DBEName;
  FrmDM.TableStdItems.Active := True;
       ItemsDBGrid.Columns[0].Title.Caption := 'ÐòºÅ';
       ItemsDBGrid.Columns[1].Title.Caption := 'Ãû³Æ';
       ItemsDBGrid.Columns[2].Title.Caption := '·ÖÀàºÅ';
       ItemsDBGrid.Columns[3].Title.Caption := '×°ÅäÍâ¹Û';
       ItemsDBGrid.Columns[4].Title.Caption := 'ÖØÁ¿';
       ItemsDBGrid.Columns[5].Title.Caption := 'Anicount';
       ItemsDBGrid.Columns[6].Title.Caption := 'Ô´¶¯Á¦';
       ItemsDBGrid.Columns[7].Title.Caption := '±£Áô';
       ItemsDBGrid.Columns[8].Title.Caption := 'ÎïÆ·Íâ¹Û';
       ItemsDBGrid.Columns[9].Title.Caption := '³Ö¾ÃÁ¦';
       ItemsDBGrid.Columns[10].Title.Caption := 'HPÉÏÏÞ¼ÓÁ¿';
       ItemsDBGrid.Columns[11].Title.Caption := '¹¥»÷¼ÓËÙ';
       ItemsDBGrid.Columns[12].Title.Caption := 'MPÉÏÏÞ¼ÓÁ¿';
       ItemsDBGrid.Columns[13].Title.Caption := '×÷ÓÃÑÓÊ±';
       ItemsDBGrid.Columns[14].Title.Caption := '×îµÍ¹¥»÷Á¦';
       ItemsDBGrid.Columns[15].Title.Caption := '×î¸ß¹¥»÷Á¦';
       ItemsDBGrid.Columns[16].Title.Caption := '×îµÍÄ§·¨Á¦';
       ItemsDBGrid.Columns[17].Title.Caption := '×î¸ßÄ§·¨Á¦';
       ItemsDBGrid.Columns[18].Title.Caption := '×îµÍµÀÊõÁ¦';
       ItemsDBGrid.Columns[19].Title.Caption := '×î¸ßµÀÊõÁ¦';
       ItemsDBGrid.Columns[20].Title.Caption := '¸½¼ÓÌõ¼þ';
       ItemsDBGrid.Columns[21].Title.Caption := 'ÐèÒªµÈ¼¶';
       ItemsDBGrid.Columns[22].Title.Caption := 'ÊÛ¼Û';
       ItemsDBGrid.Columns[23].Title.Caption := '¿â´æÁ¿';

  FrmDM.TableFongHao.DatabaseName := DBEName;
  FrmDM.TableFongHao.Active := True;
end;
//²éÕÒ¼¼ÄÜÊé
procedure TFrmMain.BtnFindMagNameClick(Sender: TObject);
begin
  if EditMagName.Text = '' then Exit;
  with FrmDM.TableMagic do begin
    if not Eof then begin
      EditKey;
      DisableControls;
      while not Eof do begin
        if pos(Trim(EditMagName.Text), FieldByName('MagName').AsString)   <=   0   then Next
        else Break;
      end;
      EnableControls;
    end;
  end;
end;
//²éÕÒ¹ÖÎï
procedure TFrmMain.BtnFindMonNameClick(Sender: TObject);
begin
  if EditMobName.Text = '' then Exit;
  with FrmDM.TableMonster do begin
    if not Eof then begin
      EditKey;
      DisableControls;
      while not Eof do begin
        if pos(Trim(EditMobName.Text), FieldByName('Name').AsString)   <=   0   then Next
        else Break;
      end;
      EnableControls;
    end;
  end;
end;
//²éÕÒÎïÆ·Ãû
procedure TFrmMain.BtnFindItemNameClick(Sender: TObject);
begin
  if EditItemsName.Text = '' then Exit;
  with FrmDM.TableStdItems do begin
    if not Eof then begin
      EditKey;
      DisableControls;
      while not Eof do begin
        if pos(Trim(EditItemsName.Text), FieldByName('Name').AsString)   <=   0   then Next
        else Break;
      end;
      EnableControls;
    end;
  end;
end;
//¹ýÂËÎïÆ·
procedure TFrmMain.ComboBoxFilterFongHaoModeChange(Sender: TObject);
  function FilterItems(Num: string):Boolean;
  begin
    Result := False;
    FrmDM.TableFongHao.Close;
    FrmDM.TableFongHao.Filter := 'Stdmode = '+Num;
    FrmDM.TableFongHao.Filtered := True;
    FrmDM.TableFongHao.Open;
    Result := True;
  end;
  function NoFilterItems():Boolean;
  begin
    Result := False;
    FrmDM.TableFongHao.Close;
    FrmDM.TableFongHao.Filter := '';
    FrmDM.TableFongHao.Filtered := False;
    FrmDM.TableFongHao.Open;
    Result := True;
  end;
begin
  case ComboBoxFilterFongHaoMode.ItemIndex of
    0: begin
        if NoFilterItems() then begin
          ListBoxFongHaoHint.Clear;
          MemoFongHaoHint.Clear;
          ListBoxFongHaoHint.Items.Add('0=Ò»°ã³ÆºÅ');
          ListBoxFongHaoHint.Items.Add('1=Ë®¾§Ö®ÐÇ(Ãâ·ÑÇ§Àï´«Òô)');
          ListBoxFongHaoHint.Items.Add('2=Ö÷Ô×ÁúÎÀ');
          ListBoxFongHaoHint.Items.Add('3=»¤»¨Ê¹Õß');
          ListBoxFongHaoHint.Items.Add('4=²»¶¯ÈçÉ½(³å×²¼¼ÄÜ+10¼¶)');
          ListBoxFongHaoHint.Items.Add('5=áÛ·åÓÂÊ¿(Ëæ»ú¹¥»÷±¶Êý,ËÀÍö3´Î»ò0µãÊ±×´Ì¬ÏûÊ§');
          ListBoxFongHaoHint.Items.Add('           Ê±¼äÉèÖÃÎÞÐ§ DC=×îµÍ±¶Êý DC2-×î¸ß±¶Êý)');
          ListBoxFongHaoHint.Items.Add('6=ÈÈÑªÊ¹Õß(Íæ¼Ò(Îª¶Ó³¤),Í¬µØÍ¼Ê±ËùÓÐ¶ÓÔ±´ò¹Ö¾­Ñé·­±¶)');
          ListBoxFongHaoHint.Items.Add('7=´«ÆæÖ®ÐÇ(Ä§·¨¶Ü,ÁÒ»ð½£·¨,ÉñÊ¥Õ½¼×Êõ,ÓÄÁé¶Ü±ä³É·ÛºìÉ«)');
          ListBoxFongHaoHint.Items.Add('8=ÐÐ»áÖ®ÐÇ(ÍË³öÐÐ»á³ÆºÅÏûÊ§)');
          ListBoxFongHaoHint.Items.Add('9=Âê·¨Ö÷Ô×Õß(ËæÒâ´«ËÍµØÍ¼)');
          ListBoxFongHaoHint.Items.Add('10=¸ß¼¶áÛ·åÓÂÊ¿(Ëæ»ú¹¥»÷±¶Êý,²»ÊÜËÀÍö´ÎÊýÏÞÖÆ');
          ListBoxFongHaoHint.Items.Add('                DC=×îµÍ±¶Êý DC2-×î¸ß±¶Êý)');
          ListBoxFongHaoHint.Items.Add('11=0µãÏûÊ§³ÆºÅ(Ê±¼äÉèÖÃÎÞÐ§)');
        end;
    end;
    1: begin
        if FilterItems('0') then begin
          ListBoxFongHaoHint.Clear;
          ListBoxFongHaoHint.Items.Add('0=Ò»°ã³ÆºÅ');
          ListBoxFongHaoHint.Items.Add('1=Ë®¾§Ö®ÐÇ(Ãâ·ÑÇ§Àï´«Òô)');
          ListBoxFongHaoHint.Items.Add('2=Ö÷Ô×ÁúÎÀ');
          ListBoxFongHaoHint.Items.Add('3=»¤»¨Ê¹Õß');
          ListBoxFongHaoHint.Items.Add('4=²»¶¯ÈçÉ½(³å×²¼¼ÄÜ+10¼¶)');
          ListBoxFongHaoHint.Items.Add('5=áÛ·åÓÂÊ¿(Ëæ»ú¹¥»÷±¶Êý,ËÀÍö3´Î»ò0µãÊ±×´Ì¬ÏûÊ§');
          ListBoxFongHaoHint.Items.Add('           Ê±¼äÉèÖÃÎÞÐ§ DC=×îµÍ±¶Êý DC2-×î¸ß±¶Êý)');
          ListBoxFongHaoHint.Items.Add('6=ÈÈÑªÊ¹Õß(Íæ¼Ò(Îª¶Ó³¤),Í¬µØÍ¼Ê±ËùÓÐ¶ÓÔ±´ò¹Ö¾­Ñé·­±¶)');
          ListBoxFongHaoHint.Items.Add('7=´«ÆæÖ®ÐÇ(Ä§·¨¶Ü,ÁÒ»ð½£·¨,ÉñÊ¥Õ½¼×Êõ,ÓÄÁé¶Ü±ä³É·ÛºìÉ«)');
          ListBoxFongHaoHint.Items.Add('8=ÐÐ»áÖ®ÐÇ(ÍË³öÐÐ»á³ÆºÅÏûÊ§)');
          ListBoxFongHaoHint.Items.Add('9=Âê·¨Ö÷Ô×Õß(ËæÒâ´«ËÍµØÍ¼)');
          ListBoxFongHaoHint.Items.Add('10=¸ß¼¶áÛ·åÓÂÊ¿(Ëæ»ú¹¥»÷±¶Êý,²»ÊÜËÀÍö´ÎÊýÏÞÖÆ');
          ListBoxFongHaoHint.Items.Add('                DC=×îµÍ±¶Êý DC2-×î¸ß±¶Êý)');
          ListBoxFongHaoHint.Items.Add('11=0µãÏûÊ§³ÆºÅ(Ê±¼äÉèÖÃÎÞÐ§)');
          MemoFongHaoHint.Clear;
          MemoFongHaoHint.Lines.Text := 'Shape  =Ô¤Áô'+#13+
                                        'Anicount=³ÆºÅÌØÊâÐ§¹û'+#13+
                                        'nHours =³ÆºÅÊ±ÏÞ(Ð¡Ê±) 65535-ÓÀ¾Ã'+#13+
                                        'Looks  =³ÆºÅµÄÄÚ¹Û'+#13+
                                        'AC     =ÌåÁ¦ÉÏÏÞ'+#13+
                                        'AC2    =Ç¿ÉíµÈ¼¶'+#13+
                                        'MAC    =ÄÚÉËµÈ¼¶'+#13+
                                        'MAC2   =±©»÷µÈ¼¶'+#13+
                                        'DC     =Âé±Ô¿¹ÐÔ'+#13+
                                        'DC2    =¹¥»÷ÉÏÏÞ'+#13+
                                        'MC     =¾ÛÄ§µÈ¼¶'+#13+
                                        'MC2    =Ä§·¨ÉÏÏÞ'+#13+
                                        'SC     =ºÏ»÷ÍþÁ¦'+#13+
                                        'SC2    =µÀÊõÉÏÏÞ'+#13+#13+
                                        'Need(¸½¼ÓÌõ¼þ)'+#13+
                                        '0:ÐèµÈ¼¶   NeedLevel=µÈ¼¶'+#13+
                                        '1:Ðè¹¥»÷Á¦ NeedLevel=¹¥»÷Á¦'+#13+
                                        '2:ÐèÄ§·¨   NeedLevel=Ä§·¨'+#13+
                                        '3:ÐèµÀÊõ   NeedLevel=µÀÊõ';
        end;
    end;
    2: begin
        if FilterItems('1') then begin
          ListBoxFongHaoHint.Clear;
          ListBoxFongHaoHint.Items.Add('0=Ò»°ã³ÆºÅ');
          ListBoxFongHaoHint.Items.Add('1=Ë®¾§Ö®ÐÇ(Ãâ·ÑÇ§Àï´«Òô)');
          ListBoxFongHaoHint.Items.Add('2=Ö÷Ô×ÁúÎÀ');
          ListBoxFongHaoHint.Items.Add('3=»¤»¨Ê¹Õß');
          ListBoxFongHaoHint.Items.Add('4=²»¶¯ÈçÉ½(³å×²¼¼ÄÜ+10¼¶)');
          ListBoxFongHaoHint.Items.Add('5=áÛ·åÓÂÊ¿(Ëæ»ú¹¥»÷±¶Êý,ËÀÍö3´Î»ò0µãÊ±×´Ì¬ÏûÊ§');
          ListBoxFongHaoHint.Items.Add('           Ê±¼äÉèÖÃÎÞÐ§ DC=×îµÍ±¶Êý DC2-×î¸ß±¶Êý)');
          ListBoxFongHaoHint.Items.Add('6=ÈÈÑªÊ¹Õß(Íæ¼Ò(Îª¶Ó³¤),Í¬µØÍ¼Ê±ËùÓÐ¶ÓÔ±´ò¹Ö¾­Ñé·­±¶)');
          ListBoxFongHaoHint.Items.Add('7=´«ÆæÖ®ÐÇ(Ä§·¨¶Ü,ÁÒ»ð½£·¨,ÉñÊ¥Õ½¼×Êõ,ÓÄÁé¶Ü±ä³É·ÛºìÉ«)');
          ListBoxFongHaoHint.Items.Add('8=ÐÐ»áÖ®ÐÇ(ÍË³öÐÐ»á³ÆºÅÏûÊ§)');
          ListBoxFongHaoHint.Items.Add('9=Âê·¨Ö÷Ô×Õß(ËæÒâ´«ËÍµØÍ¼)');
          ListBoxFongHaoHint.Items.Add('10=¸ß¼¶áÛ·åÓÂÊ¿(Ëæ»ú¹¥»÷±¶Êý,²»ÊÜËÀÍö´ÎÊýÏÞÖÆ');
          ListBoxFongHaoHint.Items.Add('                DC=×îµÍ±¶Êý DC2-×î¸ß±¶Êý)');
          ListBoxFongHaoHint.Items.Add('11=0µãÏûÊ§³ÆºÅ(Ê±¼äÉèÖÃÎÞÐ§)');
          MemoFongHaoHint.Clear;
          MemoFongHaoHint.Lines.Text := 'Anicount=¾ö¶¨³ÆºÅµÄ×÷ÓÃÐ§¹û'+#13+
                                        'Looks=³ÆºÅµÄÍâ¹Û'+#13+#13+
                                        'Need(¸½¼ÓÌõ¼þ)'+#13+
                                        '0:ÐèµÈ¼¶   NeedLevel=µÈ¼¶'+#13+
                                        '1:Ðè¹¥»÷Á¦ NeedLevel=¹¥»÷Á¦'+#13+
                                        '2:ÐèÄ§·¨   NeedLevel=Ä§·¨'+#13+
                                        '3:ÐèµÀÊõ   NeedLevel=µÀÊõ';
        end;
    end;
  end;
end;

procedure TFrmMain.ComboBoxFilterItemsModeChange(Sender: TObject);
  function FilterItems(Num: string):Boolean;
  begin
    Result := False;
    FrmDM.TableStdItems.Close;
    FrmDM.TableStdItems.Filter := 'Stdmode = '+Num;
    FrmDM.TableStdItems.Filtered := True;
    FrmDM.TableStdItems.Open;
    Result := True;
  end;
  function NoFilterItems():Boolean;
  begin
    Result := False;
    FrmDM.TableStdItems.Close;
    FrmDM.TableStdItems.Filter := '';
    FrmDM.TableStdItems.Filtered := False;
    FrmDM.TableStdItems.Open;
    Result := True;
  end;    
begin
  case ComboBoxFilterItemsMode.ItemIndex of
    0: begin
        if NoFilterItems() then begin
          ListBoxItemsHint.Clear;
          MemoItemsHint.Clear;
        end;
    end;
    1: begin
        if FilterItems('0') then begin
          ListBoxItemsHint.Clear;
          MemoItemsHint.Clear;
          ListBoxItemsHint.Items.Add('0=ÂýËÙÌí¼ÓÐÍ');
          ListBoxItemsHint.Items.Add('1=¿ìËÙÌí¼ÓÐÍ');
          ListBoxItemsHint.Items.Add('2=£¨ÉñË®£©ÐÍ');
          ListBoxItemsHint.Items.Add('3=£¨Ò©Æ¿1£©ÐÍ');
          ListBoxItemsHint.Items.Add('4=£¨Ò©Æ¿2£©ÐÍ');
          MemoItemsHint.Lines.Text := '×°ÅäÍâ¹Û(Shape)=¾ö¶¨ÁËÒ©Æ·µÄ×÷ÓÃÐ§¹û'+#13+
                                      'HPÔö¼ÓÁ¿(Ac)=ÉúÃüÖµÔö¼ÓÁ¿'+#13+
                                      'MPÔö¼ÓÁ¿(Mac)=Ä§·¨ÖµÔö¼ÓÁ¿'+#13+
                                      '×÷ÓÃÑÓÊ±(Mac2)=×÷ÓÃÓÐÐ§Ê±¼ä£¬µ¥Î»ÎªÃë';
        end;
    end;
    2: begin
        if FilterItems('1') then begin
          ListBoxItemsHint.Clear;
          MemoItemsHint.Clear;
        end;
    end;
    3: begin
        if FilterItems('2') then begin
          ListBoxItemsHint.Clear;
          ListBoxItemsHint.Items.Add('¸½¼ÓÌõ¼þ=1,ÎïÆ·²»ÄÜ·ÅÓÚ6¸ñ¿ì½Ý¿òÉÏ');
          ListBoxItemsHint.Items.Add('Anicount=21 Îª×£¸£¹ÞÀàÎïÆ·');
          MemoItemsHint.Clear;
          MemoItemsHint.Lines.Text := '×°ÅäÍâ¹Û£º'+#13+
                                      '   Shape=1,ÕÙ»½Ç¿»¯¾í'+#13+
                                      '   Shape=2,Ëæ»ú´«ËÍÊ¯'+#13+
                                      '   Shape=4,É³°Í¿ËËæ»úÊ¯'+#13+
                                      '   Shape=5,Öì»ð¶¦'+#13+
                                      '   Shape=9,ÐÞ¸´ÉñË®'+#13+
                                      '   Shape=10,Åùö¨µ¯¡¢ÌìÀ×µ¯'+#13+
                                      '   Shape=11,ºúÂÜ²·(³èÎïÏà¹Ø)'+#13+
                                      '   Shape=12,ÐÂÄê±ÞÅÚ(³èÎïÏà¹Ø)'+#13+
                                      '   Shape=253,»¤»¨ÁîÅÆ(²»µô³Ö¾Ã)'+#13+
                                      '   Shape=254,Ö÷Ô×ÁîÅÆ(²»µô³Ö¾Ã)'+#13+
                                      '   Shape=255,ÁéÆøÉñË®';
        end;
    end;
    4: begin
        if FilterItems('3') then begin
          ListBoxItemsHint.Clear;
          MemoItemsHint.Clear;
          ListBoxItemsHint.Items.Add('1=£¨µØÀÎÌÓÍÑ¾í£©');
          ListBoxItemsHint.Items.Add('2=£¨Ëæ»ú´«ËÍ¾í£©');
          ListBoxItemsHint.Items.Add('3=£¨»Ø³Ç¾í£©');
          ListBoxItemsHint.Items.Add('4=£¨×£¸£ÓÍ£©');
          ListBoxItemsHint.Items.Add('5=£¨ÐÐ»á»Ø³Ç¾í£©');
          ListBoxItemsHint.Items.Add('9=ÐÞ¸´ÓÍµÈÓÍÀà');
          ListBoxItemsHint.Items.Add('10=£¨Õ½ÉñÓÍ£©');
          ListBoxItemsHint.Items.Add('11=£¨²ÊÆ±£©');
          ListBoxItemsHint.Items.Add('12=¹¥¡¢Ä§¡¢µÀµÈ¸÷ÀàÒ©Ë®');
          ListBoxItemsHint.Items.Add('13=³ýÄ§¹¥»÷Ò©¼Á');
          ListBoxItemsHint.Items.Add('14=³ýÄ§·ÀÓùÒ©¼Á');
          MemoItemsHint.Lines.Text := '×°ÅäÍâ¹Û(Shape)=µÈÓÚ12Ê±£¬ÎªÌØÊâÒ©Ë®ÀàÎïÆ·'+#13+
                                      'shape=12µÄÌØÊâÒ©Æ·£º'+#13+
                                      '¡¡¹¥»÷Á¦Ò©Ë®£º×÷ÓÃÑÓÊ±(Mac2)=180£¬×îµÍ¹¥»÷Á¦(Dc)=5£¬Ôò¹¥»÷Á¦Ôö¼Ó5£¬×÷ÓÃÑÓÊ±180Ãë£»'+#13+
                                      '¡¡¼²·çÒ©Ë®£º×÷ÓÃÑÓÊ±(Mac2)=180£¬¹¥»÷¼ÓËÙ(Ac2)=1£¬Ôò¹¥»÷ËÙ¶ÈË²¼äÌá¸ß180Ãë£»'+#13+
                                      '¡¡HPÇ¿»¯Ë®£º×÷ÓÃÑÓÊ±(Mac2)=120£¬HPÉÏÏÞ¼ÓÁ¿(Ac)=50£¬ÔòHPÉÏÏÞÔö¼Ó50£¬×÷ÓÃÑÓÊ±120Ãë'+#13+#13+
                                      'shape=13 ³ýÄ§¹¥»÷Ò©¼Á'+#13+
                                      '  ×÷ÓÃÑÓÊ±(Mac2)=3600£¬HPÉÏÏÞ¼ÓÁ¿(Ac)=10 Ê¹ÓÃÊ±¸ù¾ÝÖ°Òµ£¬Ëæ»úÔö¼Ó10¶ÔÓ¦ÊôÐÔ£¬Ê±¼ä3600Ãë'+#13+#13+
                                      'shape=14 ³ýÄ§·ÀÓùÒ©¼Á'+#13+
                                      '  ×÷ÓÃÑÓÊ±(Mac2)=3600£¬HPÉÏÏÞ¼ÓÁ¿(Ac)=10 Ê¹ÓÃÊ±£¬Ëæ»úÔö¼Ó·ÀÓù»òÄ§·À£¬Ëæ»úÔö¼Ó10¶ÔÓ¦ÊôÐÔ£¬Ê±¼ä3600Ãë'+#13+#13+
                                      '²»µÈÓÚ12Ê±£¬ÎªÒ»°ãµÄ¾íÊé¡¢ÓÍ¡¢²ÊÆ±ÎïÆ·£»';
       end;
    end;


    5: begin
        if FilterItems('4') then begin
          ListBoxItemsHint.Clear;
          MemoItemsHint.Clear;
          ListBoxItemsHint.Items.Add('×Ö¶Î×°±¸Íâ¹Û:');
          ListBoxItemsHint.Items.Add('0=Õ½Ê¿Ö°ÒµÓÃ');
          ListBoxItemsHint.Items.Add('1=·¨Ê¦Ö°ÒµÓÃ');
          ListBoxItemsHint.Items.Add('2=µÀÊ¿Ö°ÒµÓÃ');
          ListBoxItemsHint.Items.Add('99=(Í¨ÓÃ)');

          MemoItemsHint.Lines.Text := 'Ñ§Ï°µÈ¼¶(DuraMax)=ÎªÐÞÏ°Ê±ËùÐèÒªµÄµÈ¼¶£¬¶ø²»ÊÇ¡°ÐèÒªµÈ¼¶(NeedLevel)¡±£¡'+#13+
                                      'Source=127Ê±,¿ÉÒÔÔö¼Ó»ðÁúÖ®ÐÄµÄÅ­Æø(Reserved*100=Ôö¼ÓÅ­ÆøÖµ)'+#13+
                                      'Anicount(0-ÆÕÍ¨Êé 1-ÄÚ¹¦Êé)'+#13+
                                      'ËÄ¼¶¼¼ÄÜÊé(AC 0-Ö÷ÌåÊé 1-Ó¢ÐÛÊé)';
        end;
    end;
    6: begin
        if FilterItems('5') then begin
          ListBoxItemsHint.Clear;
          MemoItemsHint.Clear;
          ListBoxItemsHint.Items.Add('0=ÎªÐÂÎäÆ÷±£Áô');
          ListBoxItemsHint.Items.Add('1=£¨Ä¾½£¡¢ÎÚÄ¾½££©');
          ListBoxItemsHint.Items.Add('2=£¨Ìú½£¡¢ÇàÍ­½££©');
          ListBoxItemsHint.Items.Add('3=£¨ÇàÍ­¸«£©');
          ListBoxItemsHint.Items.Add('4=£¨¶Ì½££©');
          ListBoxItemsHint.Items.Add('5=£¨Áè·ç£©');
          ListBoxItemsHint.Items.Add('6=£¨ÆÆ»ê¡¢Ø°Ê×£©');
          ListBoxItemsHint.Items.Add('7=£¨ÐÞÂÞ£©');
          ListBoxItemsHint.Items.Add('9=£¨ÒøÉß£©');
          ListBoxItemsHint.Items.Add('10=£¨Õ¶Âíµ¶£©');
          ListBoxItemsHint.Items.Add('13=£¨ÄýËª£©');
          ListBoxItemsHint.Items.Add('14=£¨½µÄ§£©');
          ListBoxItemsHint.Items.Add('15=£¨°Ë»Ä£©');
          ListBoxItemsHint.Items.Add('16=£¨°ëÔÂ£©');
          ListBoxItemsHint.Items.Add('17=£¨¾®ÖÐÔÂ¡¢Õ¶ÔÂµ¶£©');
          ListBoxItemsHint.Items.Add('21=£¨ÎÞ¼«¹÷£©');
          ListBoxItemsHint.Items.Add('22=£¨ÑªÒû£©');
          ListBoxItemsHint.Items.Add('23=£¨Æíµ»Ö®ÈÐ£©');
          ListBoxItemsHint.Items.Add('25=£¨ÁúÎÆ½£¡¢Áú¹Ç½££©');
          ListBoxItemsHint.Items.Add('26=£¨ÍÀÁú¡¢GMÍÀÁú£©');
          ListBoxItemsHint.Items.Add('29=£¨ÃüÔËÖ®ÈÐ£©');
          ListBoxItemsHint.Items.Add('30=£¨³àÑªÄ§½£¡¢GM½££©');
          ListBoxItemsHint.Items.Add('31=£¨Í³Ë§Ö®ÈÐ£©');
          ListBoxItemsHint.Items.Add('32=£¨½®ÓòÖ®ÕÈ£©');
          ListBoxItemsHint.Items.Add('33=£¨ÓñÖñÉÈ£©');
          ListBoxItemsHint.Items.Add('75=£¨ÎÚ½ð²ù£©');
          ListBoxItemsHint.Items.Add('76=£¨½ð¸Õ²ù£©');
          ListBoxItemsHint.Items.Add('77=£¨ÐÂÊÖ²ù¡¢Ìú²ù£©');
          MemoItemsHint.Lines.Text := '¹¥»÷¼ÓËÙÊÇ×¼È·'+#13+
                                      '×÷ÓÃÑÓÊ±ÊÇÃô½Ý'+#13+
                                      'Ô´¶¯Á¦ÊÇÉñÊ¥Ç¿¶È'+#13+
                                      '×°ÅäÍâ¹Û(Shape)=ÈËÎï×°ÅäÍâ¹Û£¬¸ÃÊýÖµÏàÍ¬µÄÎïÆ·£¬ÔÚÈËÎïÍâ¹ÛÉÏ¿´Ò²ÏàÍ¬'+#13+
                                      'Ç¿¶ÈÉñÊ¥(Source)=Õý£ºÇ¿¶È£¨½¨ÒéÖµ£º0~100£©£»¸º£ºÉñÊ¥£¨½¨ÒéÖµ£º-100~0£©'+#13+
                                      'ÎïÆ·Íâ¹Û(Looks)=¸ÃÊýÖµÏàÍ¬µÄÎïÆ·£¬ÔÚÎïÆ·À¸ÖÐÍâ¹ÛÒ²ÏàÍ¬'+#13+
                                      '³Ö¾Ã¶È(DuraMax)=ÒÔ1000Îªµ¥Î»£¬1000¼´Îª1¸öµãµÄ³Ö¾Ã'+#13+
                                      'ÐÒÔË(AC)=£¨½¨ÒéÖµ£º0~100£©'+#13+
                                      '×¼È·(AC2)=£¨½¨ÒéÖµ£º0~200£©'+#13+
                                      '×çÖä(Mac)=£¨½¨ÒéÖµ£º0~100£©'+#13+
                                      '¹¥»÷ËÙ¶È(Mac2)=¼ÆËã¹«Ê½£º¹¥»÷ËÙ¶È=246+X£¬XÎªËùÌîÊýÖµ£¬±ØÐëÎª¸ºÊý£¬Èç£º¹¥»÷ËÙ¶È+6£¬ÔòÉèMac2=-240£»½¨ÒéÖµ£º-236~0'+#13+
                                      'ÐèÒªµÈ¼¶(Need)Óë¸½¼ÓÌõ¼þ(NeedLevel)=ÐèÒªÅäºÏÊ¹ÓÃ£¬'+#13+
                                      '  Need=0Ê±NeedLevelÎªËùÐèµÈ¼¶£»'+#13+
                                      '  Need=1Ê±NeedLevelÎªËùÐè¹¥»÷Á¦£»'+#13+
                                      '  Need=2Ê±NeedLevelÎªËùÐèÄ§·¨Á¦£»'+#13+
                                      '  Need=3Ê±NeedLevelÎªËùÐèµÀÊõÁ¦';
        end;
    end;
    7: begin
        if FilterItems('6') then begin
          ListBoxItemsHint.Clear;
          MemoItemsHint.Clear;
          ListBoxItemsHint.Items.Add('8=£¨º£»ê£©');
          ListBoxItemsHint.Items.Add('11=£¨Á¶Óü¡¢Õ¶Ìì£©');
          ListBoxItemsHint.Items.Add('12=£¨Ä§ÕÈ¡¢·¨ÕÈ£©');
          ListBoxItemsHint.Items.Add('18=£¨ÙÈÔÂ£©');
          ListBoxItemsHint.Items.Add('19=£¨º××ì³ú£©');
          ListBoxItemsHint.Items.Add('24=£¨²Ã¾öÖ®ÕÈ£©');
          ListBoxItemsHint.Items.Add('27=£¨ÊÈ»ê·¨ÕÈ¡¢GMÈ¨ÕÈ£©');
          ListBoxItemsHint.Items.Add('28=£¨¹ÇÓñÈ¨ÕÈ¡¢±ÌÓñÈ¨ÕÈ£©');
          MemoItemsHint.Lines.Text := '×°ÅäÍâ¹Û(Shape)=ÈËÎï×°ÅäÍâ¹Û£¬¸ÃÊýÖµÏàÍ¬µÄÎïÆ·£¬ÔÚÈËÎïÍâ¹ÛÉÏ¿´Ò²ÏàÍ¬'+#13+
                                      'Ç¿¶ÈÉñÊ¥(Source)=Õý£ºÇ¿¶È£¨½¨ÒéÖµ£º0~100£©£»¸º£ºÉñÊ¥£¨½¨ÒéÖµ£º-100~0£©'+#13+
                                      'ÎïÆ·Íâ¹Û(Looks)=¸ÃÊýÖµÏàÍ¬µÄÎïÆ·£¬ÔÚÎïÆ·À¸ÖÐÍâ¹ÛÒ²ÏàÍ¬'+#13+
                                      '³Ö¾Ã¶È(DuraMax)=ÒÔ1000Îªµ¥Î»£¬1000¼´Îª1¸öµãµÄ³Ö¾Ã'+#13+
                                      'ÐÒÔË(AC)=£¨½¨ÒéÖµ£º0~100£©'+#13+
                                      '×¼È·(AC2)=£¨½¨ÒéÖµ£º0~200£©'+#13+
                                      '×çÖä(Mac)=£¨½¨ÒéÖµ£º0~100£©'+#13+
                                      '¹¥»÷ËÙ¶È(Mac2)=¼ÆËã¹«Ê½£º¹¥»÷ËÙ¶È=246+X£¬XÎªËùÌîÊýÖµ£¬±ØÐëÎª¸ºÊý£¬Èç£º¹¥»÷ËÙ¶È+6£¬ÔòÉèMac2=-240£»½¨ÒéÖµ£º-236~0'+#13+
                                      'ÐèÒªµÈ¼¶(Need)Óë¸½¼ÓÌõ¼þ(NeedLevel)=ÐèÒªÅäºÏÊ¹ÓÃ£¬Need=0Ê±NeedLevelÎªËùÐèµÈ¼¶£»Need=1Ê±NeedLevelÎªËùÐè¹¥»÷Á¦£»Need=2Ê±NeedLevelÎªËùÐèÄ§·¨Á¦£»Need=3Ê±NeedLevelÎªËùÐèµÀÊõÁ¦';
        end;
    end;

    8: begin
        if FilterItems('7') then begin
          ListBoxItemsHint.Clear;
          MemoItemsHint.Clear;
          MemoItemsHint.Lines.Text := '×°ÅäÍâ¹Û(Shape) 0 Ç§Àï´«µ¥'+#13+
                                      '                1 ÆøÑªÊ¯'+#13+
                                      '                2 »ÃÄ§Ê¯'+#13+
                                      '                3 Ä§ÑªÊ¯'+#13+
                                      '                4 ´«ÒôÍ²'+#13+
                                      '                5 ÌìÁúÓ¡¡¢»ðÁúÓ¡';
        end;
    end;
    9:begin
        if FilterItems('8') then begin
          ListBoxItemsHint.Clear;
          MemoItemsHint.Clear;
          MemoItemsHint.Lines.Text := '×°ÅäÍâ¹Û(Shape)=0-ÆÕÍ¨²ÄÁÏ 1-¾«ÖÆ²ÄÁÏ'+#13+
                                      'Anicount=¾Æ(Shape)Ê±²ÅÄÜÄðÔì³ö¾Æ,'+#13+
                                      '±£Áô(Reserved)=²ÄÁÏËù¾ßÓÐµÄ¾Æ¾«¶È'+#13+
                                      'HPÉÏÏÞ¼ÓÁ¿(AC)=¾«ÖÆ²ÄÁÏËù¾ßÓÐµÄÆ·ÖÊ';
        end;
    end;
    10:begin
        if FilterItems('9') then begin
          ListBoxItemsHint.Clear;
          MemoItemsHint.Clear;
        end;
    end;
    11: begin
        if FilterItems('10') then begin
          ListBoxItemsHint.Clear;
          MemoItemsHint.Clear;
          ListBoxItemsHint.Items.Add('1=²¼ÒÂ');
          ListBoxItemsHint.Items.Add('2=Çá¿ø');
          ListBoxItemsHint.Items.Add('3=ÖØ¿ø');
          ListBoxItemsHint.Items.Add('4=Ä§·¨³¤ÅÛ');
          ListBoxItemsHint.Items.Add('5=Áé»êÕ½ÒÂ');
          MemoItemsHint.Lines.Text := 'HPÉÏÏÞºÍ¹¥»÷¼ÓËÙÊÇ·ÀÓùÉÏÏÞºÍÏÂÏÞ'+#13+
                                      'MPÉÏÏÞºÍ×÷ÓÃÑÓÊ±ÊÇÄ§ÓùÉÏÏÞºÍÏÂÏÞ';
        end;
    end;
    12: begin
        if FilterItems('11') then begin
          ListBoxItemsHint.Clear;
          MemoItemsHint.Clear;
          ListBoxItemsHint.Items.Add('1=²¼ÒÂ');
          ListBoxItemsHint.Items.Add('2=Çá¿ø');
          ListBoxItemsHint.Items.Add('3=ÖØ¿ø');
          ListBoxItemsHint.Items.Add('4=Ä§·¨³¤ÅÛ');
          ListBoxItemsHint.Items.Add('5=Áé»êÕ½ÒÂ');
          MemoItemsHint.Lines.Text := 'HPÉÏÏÞºÍ¹¥»÷¼ÓËÙÊÇ·ÀÓùÉÏÏÞºÍÏÂÏÞ'+#13+
                                      'MPÉÏÏÞºÍ×÷ÓÃÑÓÊ±ÊÇÄ§ÓùÉÏÏÞºÍÏÂÏÞ';
        end;
    end;
    13:begin
        if FilterItems('12') then begin
          ListBoxItemsHint.Clear;
          MemoItemsHint.Clear;
          MemoItemsHint.Lines.Text := '×°ÅäÍâ¹Û(Shape) 0-ÆÕÍ¨¾ÆÊ¹ÓÃ 1-Ò©¾ÆÊ¹ÓÃ';
        end;
    end;
    14:begin
        if FilterItems('13') then begin
          ListBoxItemsHint.Clear;
          MemoItemsHint.Clear;
          MemoItemsHint.Lines.Text := '×°ÅäÍâ¹Û(Shape)=Ö÷²ÄÁÏµÄAniCount,¼ÓÆ·ÖÊ+1';
        end;
    end;
    15:begin
        if FilterItems('14') then begin
          ListBoxItemsHint.Clear;
          MemoItemsHint.Clear;
          MemoItemsHint.Lines.Text := 'Anicount¶ÔÓ¦¾Æ(Shape)Ê±²ÅÄÜÄðÔì³ö¾Æ';
        end;
    end;
    16: begin
        if FilterItems('15') then begin
          ListBoxItemsHint.Clear;
          MemoItemsHint.Clear;
          ListBoxItemsHint.Items.Add('0=ÆÕÍ¨Í·¿ø');
          ListBoxItemsHint.Items.Add('125=¼ÇÒäÍ·¿ø');
          ListBoxItemsHint.Items.Add('129=Æíµ»Í·¿ø');
          ListBoxItemsHint.Items.Add('132=ÉñÃØÍ·¿ø');
          MemoItemsHint.Lines.Text := 'HPÉÏÏÞºÍ¹¥»÷¼ÓËÙÊÇ·ÀÓùÉÏÏÞºÍÏÂÏÞ'+#13+
                                      'MPÉÏÏÞºÍ×÷ÓÃÑÓÊ±ÊÇÄ§ÓùÉÏÏÞºÍÏÂÏÞ';
        end;
    end;
    17: begin
        if FilterItems('16') then begin
          ListBoxItemsHint.Clear;
          MemoItemsHint.Clear;
          ListBoxItemsHint.Items.Add('ÆÕÍ¨¶·óÒ(ShapeÎª0)¿É¿ØÖÆÏÔÊ¾ÉñÃØÈË');
          ListBoxItemsHint.Items.Add('ÍõÕß¶·óÒ(ShapeÎª1)¿É¿ØÖÆÏÔÊ¾ÉñÃØÈË');
          ListBoxItemsHint.Items.Add('ºÚ    ½í(ShapeÎª2)²»ÏÔÊ¾ÉñÃØÈË');
          ListBoxItemsHint.Items.Add('±ØÉ±¶·óÒ(ShapeÎª3)¿É¿ØÖÆÏÔÊ¾ÉñÃØÈË');
          ListBoxItemsHint.Items.Add('½ðÅ£¶·óÒ(ShapeÎª4)¿É¿ØÖÆÏÔÊ¾ÉñÃØÈË');
          ListBoxItemsHint.Items.Add('Ö÷Ô×¶·óÒ(ShapeÎª5)¿É¿ØÖÆÏÔÊ¾ÉñÃØÈË');
          ListBoxItemsHint.Items.Add('´«Ææ¶·óÒ(ShapeÎª6)¿É¿ØÖÆÏÔÊ¾ÉñÃØÈË');
          ListBoxItemsHint.Items.Add('ð©ÔÂ¶·óÒ(ShapeÎª7)¿É¿ØÖÆÏÔÊ¾ÉñÃØÈË');
          MemoItemsHint.Lines.Text := '´©´÷¿ØÖÆ£º'+#13+
                                      'Anicount 0-Ö÷ÌåÓ¢ÐÛÈ«¿É´ø'+#13+
                                      '         1-Ö÷Ìå¿É´ø'+#13+
                                      '         2-Ó¢ÐÛ¿É´ø'+#13+
                                      'Ô´¶¯Á¦(0-125) »÷É±¶ÔÊÖÊ±£¬¶ÔÊÖ±¬ÂÊÔö¼Ó';
        end;
    end;
    18: begin
      if FilterItems('17') then begin
        ListBoxItemsHint.Clear;
        MemoItemsHint.Clear;
        ListBoxItemsHint.Items.Add('Shape:');
        ListBoxItemsHint.Items.Add('  0-6 ½ðÕëÀà,±íÊ¾µÈ¼¶(¶ÔÓ¦·ûµÈ¼¶)');
        ListBoxItemsHint.Items.Add('  237 Ò©Æ·(Ë«»÷Ê¹ÓÃ)');
        ListBoxItemsHint.Items.Add('  238 ÎªÆæ¾­ÅàÔªµ¤');
        ListBoxItemsHint.Items.Add('  239-241 Îª1-3¾íÖá(¼ø¶¨)');
        ListBoxItemsHint.Items.Add('  242 Îª³àÑ×Ê¯ËéÆ¬');
        ListBoxItemsHint.Items.Add('  243-252 Îª1-10¼¶³àÑ×Ê¯');
        ListBoxItemsHint.Items.Add('  253-255 ÎªÓ¢ÐÛ¾­ÂçÍè');

        MemoItemsHint.Lines.Text := 'Ô´¶¯Á¦ 0-ÏÔÊ¾ÖØÁ¿'+#13+
                                    'DuraMax(³Ö¾Ã)-¿Éµþ¼ÓÉÏÏÞÖµ'+#13+
                                    'Anicount:'+#13+
                                    '  (Õë)-ºÏ³É³É¹¦ÂÊ'+#13+
                                    '  (Ó¢ÐÛ¾­ÂçÍè)-Ó¢ÐÛ¾­Âç¾­Ñé'+#13+
                                    '  (Ææ¾­ÅàÔªµ¤)-Ææ¾­¾­Ñé 1:1000'+#13+
                                    '  (Ò©Æ·)0-ÂýËÙÐÍ 1-¿ìËÙÐÍ'+#13+
                                    'Reserved-ºÏ³Éºó¸øÎïÆ·µÄ±êÊ¶,Àý2'+#13+
                                    '   ,ºÏ³É³É¹¦¸øÕë(·ÖÀà17,Íâ¹Û2)'+#13+
                                    'Ac--(Ò©Æ·Àà)ÉúÃüÖµÔö¼ÓÁ¿'+#13+
                                    'Mac-(Ò©Æ·Àà)Ä§·¨ÖµÔö¼ÓÁ¿'+#13+
                                    'Dc--(Ò©Æ·Àà)>0Ê±¿É½øÐÐÎüÊÕÐÄ·¨¾­Ñé';
      end;
    end;
    19: begin
      if FilterItems('18') then begin
        ListBoxItemsHint.Clear;
        MemoItemsHint.Clear;
        ListBoxItemsHint.Items.Add('Shape--±íÊ¾µÈ¼¶(ÓëÕëµÄµÈ¼¶¶ÔÓ¦)');
        ListBoxItemsHint.Items.Add('Ô´¶¯Á¦ 0-ÏÔÊ¾ÖØÁ¿');
        ListBoxItemsHint.Items.Add('DuraMax(³Ö¾Ã)--¿Éµþ¼ÓÉÏÏÞÖµ');
        ListBoxItemsHint.Items.Add('Anicount--ºÏ³É³É¹¦ÂÊ');
        MemoItemsHint.Lines.Text := '¶ÍÁ¶½ðÕëËùÐèÐÒÔË·ûÎïÆ·';
      end;
    end;
    20: begin
        if FilterItems('19') then begin
          ListBoxItemsHint.Clear;
          MemoItemsHint.Clear;
          ListBoxItemsHint.Items.Add('0=µÆÁý¡¢°×É«»¢³Ý¡¢Ë®Óò');
          ListBoxItemsHint.Items.Add('123=¼ÇÒäÏîÁ´');
          MemoItemsHint.Lines.Text := '×÷ÓÃÑÓÊ± Îª ÐÒÔË '+#13+
                                      '¹¥»÷¼ÓËÙ Îª Ä§·¨¶ã±Ü'+#13+
                                      '×°ÅäÍâ¹Û(Shape)=ÈËÎï×°ÅäÍâ¹Û£¬¸ÃÊýÖµÏàÍ¬µÄÎïÆ·£¬ÔÚÈËÎïÍâ¹ÛÉÏ¿´Ò²ÏàÍ¬'+#13+
                                      'Ô´¶¯Á¦(0-125) »÷É±¶ÔÊÖÊ±£¬¶ÔÊÖ±¬ÂÊÔö¼Ó'+#13+
                                      'ÎïÆ·Íâ¹Û(Looks)=¸ÃÊýÖµÏàÍ¬µÄÎïÆ·£¬ÔÚÎïÆ·À¸ÖÐÍâ¹ÛÒ²ÏàÍ¬'+#13+
                                      '³Ö¾Ã¶È(DuraMax)=ÒÔ1000Îªµ¥Î»£¬1000¼´Îª1¸öµãµÄ³Ö¾Ã'+#13+
                                      'Ä§·¨¶ã±Ü(Ac2)=£¨1£½10%£¬2£½20%£¬¡­£¬½¨ÒéÖµ£º0~100£©'+#13+
                                      '×çÖä(Mac)=£¨½¨ÒéÖµ£º0~100£©'+#13+
                                      'ÐÒÔË(Mac2)=£¨½¨ÒéÖµ£º0~100£©'+#13+
                                      '×îµÍÓë×î¸ß¹¥»÷Á¦(Dc¡¢Dc2)=£¨½¨ÒéÖµ£º0~200£©'+#13+
                                      '×îµÍÓë×î¸ßÄ§·¨Á¦(Mc¡¢Mc2)=£¨½¨ÒéÖµ£º0~200£©'+#13+
                                      '×îµÍÓë×î¸ßµÀÊõÁ¦(Sc¡¢Sc2)=£¨½¨ÒéÖµ£º0~200£©'+#13+
                                      'ÐèÒªµÈ¼¶(Need)Óë¸½¼ÓÌõ¼þ(NeedLevel)=ÐèÒªÅäºÏÊ¹ÓÃ£¬Need=0Ê±NeedLevelÎªËùÐèµÈ¼¶£»Need=1Ê±NeedLevelÎªËùÐè¹¥»÷Á¦£»Need=2Ê±NeedLevelÎªËùÐèÄ§·¨Á¦£»Need=3Ê±NeedLevelÎªËùÐèµÀÊõÁ¦';
        end;
    end;
    21: begin
        if FilterItems('20') then begin
          ListBoxItemsHint.Clear;
          MemoItemsHint.Clear;
          ListBoxItemsHint.Items.Add('0=ÆÕÍ¨ÏîÁ´');
          ListBoxItemsHint.Items.Add('113=¸¡ÓÄÏîÁ´');
          ListBoxItemsHint.Items.Add('120=¼¼ÇÉÏîÁ´');
          ListBoxItemsHint.Items.Add('121=Ì½²âÏîÁ´');
          ListBoxItemsHint.Items.Add('135=À¼»¨ÏîÁ´');
          ListBoxItemsHint.Items.Add('138=µÐÄÑÏîÁ´');
          MemoItemsHint.Lines.Text := '¹¥»÷¼ÓËÙÊÇ×¼È·'+#13+
                                      '×÷ÓÃÑÓÊ±ÊÇÃô½Ý'+#13+
                                      '×°ÅäÍâ¹Û(Shape)=ÈËÎï×°ÅäÍâ¹Û£¬¸ÃÊýÖµÏàÍ¬µÄÎïÆ·£¬ÔÚÈËÎïÍâ¹ÛÉÏ¿´Ò²ÏàÍ¬'+#13+
                                      'ÎïÆ·Íâ¹Û(Looks)=¸ÃÊýÖµÏàÍ¬µÄÎïÆ·£¬ÔÚÎïÆ·À¸ÖÐÍâ¹ÛÒ²ÏàÍ¬'+#13+
                                      '³Ö¾Ã¶È(DuraMax)=ÒÔ1000Îªµ¥Î»£¬1000¼´Îª1¸öµãµÄ³Ö¾Ã'+#13+
                                      '×¼È·(Ac2)=£¨½¨ÒéÖµ£º0~100£©'+#13+
                                      'Ãô½Ý(Mac2)=£¨½¨ÒéÖµ£º0~100£©'+#13+
                                      '×îµÍÓë×î¸ß¹¥»÷Á¦(Dc¡¢Dc2)=£¨½¨ÒéÖµ£º0~200£©'+#13+
                                      '×îµÍÓë×î¸ßÄ§·¨Á¦(Mc¡¢Mc2)=£¨½¨ÒéÖµ£º0~200£©'+#13+
                                      '×îµÍÓë×î¸ßµÀÊõÁ¦(Sc¡¢Sc2)=£¨½¨ÒéÖµ£º0~200£©'+#13+
                                      'ÐèÒªµÈ¼¶(Need)Óë¸½¼ÓÌõ¼þ(NeedLevel)=ÐèÒªÅäºÏÊ¹ÓÃ£¬Need=0Ê±NeedLevelÎªËùÐèµÈ¼¶£»Need=1Ê±NeedLevelÎªËùÐè¹¥»÷Á¦£»Need=2Ê±NeedLevelÎªËùÐèÄ§·¨Á¦£»Need=3Ê±NeedLevelÎªËùÐèµÀÊõÁ¦';
        end;
    end;
    22: begin
        if FilterItems('21') then begin
          ListBoxItemsHint.Clear;
          MemoItemsHint.Clear;
          ListBoxItemsHint.Items.Add('0=¿ñ·çÏîÁ´');
          ListBoxItemsHint.Items.Add('113=Æíµ»ÏîÁ´');
          ListBoxItemsHint.Items.Add('127=GMÏîÁ´');
          MemoItemsHint.Lines.Text := 'HPÉÏÏÞ Ó¦¸ÃÊÇ¹¥»÷¼ÓËÙ'+#13+
                                      '¹¥»÷¼ÓËÙÓ¦¸ÃÊÇÌåÁ¦»Ö¸´'+#13+
                                      '×÷ÓÃÑÓÊ±Ó¦¸ÃÊÇÄ§·¨»Ö¸´'+#13+
                                      '×°ÅäÍâ¹Û(Shape)=ÈËÎï×°ÅäÍâ¹Û£¬¸ÃÊýÖµÏàÍ¬µÄÎïÆ·£¬ÔÚÈËÎïÍâ¹ÛÉÏ¿´Ò²ÏàÍ¬'+#13+
                                      'ÎïÆ·Íâ¹Û(Looks)=¸ÃÊýÖµÏàÍ¬µÄÎïÆ·£¬ÔÚÎïÆ·À¸ÖÐÍâ¹ÛÒ²ÏàÍ¬'+#13+
                                      '³Ö¾Ã¶È(DuraMax)=ÒÔ1000Îªµ¥Î»£¬1000¼´Îª1¸öµãµÄ³Ö¾Ã'+#13+
                                      '£«¹¥»÷ËÙ¶È(Ac)=£¨½¨ÒéÖµ£º0~10£©'+#13+
                                      'ÌåÁ¦»Ö¸´(Ac2)=£¨1£½10%£¬2£½20%£¬¡­£¬½¨ÒéÖµ£º0~100£©'+#13+
                                      '£­¹¥»÷ËÙ¶È(Mac)=£¨½¨ÒéÖµ£º0~10£©'+#13+
                                      'Ä§·¨»Ö¸´(Mac2)=£¨1£½10%£¬2£½20%£¬¡­£¬½¨ÒéÖµ£º0~100£©'+#13+
                                      '×îµÍÓë×î¸ß¹¥»÷Á¦(Dc¡¢Dc2)=£¨½¨ÒéÖµ£º0~200£©'+#13+
                                      '×îµÍÓë×î¸ßÄ§·¨Á¦(Mc¡¢Mc2)=£¨½¨ÒéÖµ£º0~200£©'+#13+
                                      '×îµÍÓë×î¸ßµÀÊõÁ¦(Sc¡¢Sc2)=£¨½¨ÒéÖµ£º0~200£©'+#13+
                                      'ÐèÒªµÈ¼¶(Need)Óë¸½¼ÓÌõ¼þ(NeedLevel)=ÐèÒªÅäºÏÊ¹ÓÃ£¬Need=0Ê±NeedLevelÎªËùÐèµÈ¼¶£»Need=1Ê±NeedLevelÎªËùÐè¹¥»÷Á¦£»Need=2Ê±NeedLevelÎªËùÐèÄ§·¨Á¦£»Need=3Ê±NeedLevelÎªËùÐèµÀÊõÁ¦';
        end;
    end;
    23: begin
        if FilterItems('22') then begin
          ListBoxItemsHint.Clear;
          MemoItemsHint.Clear;
          ListBoxItemsHint.Items.Add('0=ÆÕÍ¨½äÖ¸');
          ListBoxItemsHint.Items.Add('111=ÒþÉí½äÖ¸');
          ListBoxItemsHint.Items.Add('112=´«ËÍ½äÖ¸');
          ListBoxItemsHint.Items.Add('113=Âé±Ô½äÖ¸');
          ListBoxItemsHint.Items.Add('114=¸´»î½äÖ¸');
          ListBoxItemsHint.Items.Add('115=»ðÑæ½äÖ¸');
          ListBoxItemsHint.Items.Add('116=ÖÎÓú½äÖ¸');
          ListBoxItemsHint.Items.Add('117=·ßÅ­½äÖ¸');
          ListBoxItemsHint.Items.Add('118=»¤Éí½äÖ¸');
          ListBoxItemsHint.Items.Add('119=³¬¸ºÔØ½äÖ¸');
          ListBoxItemsHint.Items.Add('122,123,124,125=¼ÇÒä½äÖ¸');
          ListBoxItemsHint.Items.Add('130,131,132=ÉñÃØ½äÖ¸');
          ListBoxItemsHint.Items.Add('133=À¼»¨½äÖ¸');
          ListBoxItemsHint.Items.Add('136=µÐÄÑ½äÖ¸');
          ListBoxItemsHint.Items.Add('169=Á÷ÐÇ»ðÓê½äÖ¸');
          ListBoxItemsHint.Items.Add('189=¾ÛÄ§»¤Éí½äÖ¸');
          ListBoxItemsHint.Items.Add('190=Õ½ÒâÂé±Ô½äÖ¸');
          ListBoxItemsHint.Items.Add('191=Ä§µÀÂé±Ô½äÖ¸');
          ListBoxItemsHint.Items.Add('192=ÒÐÌì±ÙµØ¼¼ÄÜ');
          ListBoxItemsHint.Items.Add('197=ÖØÉú½äÖ¸');
          MemoItemsHint.Lines.Text := 'HPÉÏÏÞºÍ¹¥»÷¼ÓËÙÊÇ·ÀÓùÉÏÏÞºÍ·ÀÓùÏÂÏÞ'+#13+
                                      'MPÉÏÏÞºÍ×÷ÓÃÑÓÊ±Ó¦¸ÃÊÇÄ§ÓùÉÏÏÞºÍÏÂÏÞ'+#13+
                                      '×°ÅäÍâ¹Û(Shape)=ÈËÎï×°ÅäÍâ¹Û£¬¸ÃÊýÖµÏàÍ¬µÄÎïÆ·£¬ÔÚÈËÎïÍâ¹ÛÉÏ¿´Ò²ÏàÍ¬'+#13+
                                      'ÎïÆ·Íâ¹Û(Looks)=¸ÃÊýÖµÏàÍ¬µÄÎïÆ·£¬ÔÚÎïÆ·À¸ÖÐÍâ¹ÛÒ²ÏàÍ¬'+#13+
                                      '³Ö¾Ã¶È(DuraMax)=ÒÔ1000Îªµ¥Î»£¬1000¼´Îª1¸öµãµÄ³Ö¾Ã'+#13+
                                      '×îµÍÓë×î¸ß¹¥·À(Ac¡¢Ac2)=£¨½¨ÒéÖµ£º0~200£©'+#13+
                                      '×îµÍÓë×î¸ßÄ§Óù(Mac¡¢Mac2)=£¨½¨ÒéÖµ£º0~200£©'+#13+
                                      '×îµÍÓë×î¸ß¹¥»÷Á¦(Dc¡¢Dc2)=£¨½¨ÒéÖµ£º0~200£©'+#13+
                                      '×îµÍÓë×î¸ßÄ§·¨Á¦(Mc¡¢Mc2)=£¨½¨ÒéÖµ£º0~200£©'+#13+
                                      '×îµÍÓë×î¸ßµÀÊõÁ¦(Sc¡¢Sc2)=£¨½¨ÒéÖµ£º0~200£©'+#13+
                                      'ÐèÒªµÈ¼¶(Need)Óë¸½¼ÓÌõ¼þ(NeedLevel)=ÐèÒªÅäºÏÊ¹ÓÃ£¬Need=0Ê±NeedLevelÎªËùÐèµÈ¼¶£»Need=1Ê±NeedLevelÎªËùÐè¹¥»÷Á¦£»Need=2Ê±NeedLevelÎªËùÐèÄ§·¨Á¦£»Need=3Ê±NeedLevelÎªËùÐèµÀÊõÁ¦';
        end;
    end;
    24: begin
        if FilterItems('23') then begin
          ListBoxItemsHint.Clear;
          MemoItemsHint.Clear;
          ListBoxItemsHint.Items.Add('0=÷ÈÁ¦¡¢µÀµÂ¡¢¿ñ·ç½äÖ¸');
          ListBoxItemsHint.Items.Add('113=¿¼Ë¹½äÖ¸');
          ListBoxItemsHint.Items.Add('114=±´Ë¹½äÖ¸');
          ListBoxItemsHint.Items.Add('119=ÖæË¹½äÖ¸');
          ListBoxItemsHint.Items.Add('128=Æíµ»½äÖ¸');
          MemoItemsHint.Lines.Text := 'HPÉÏÏÞÊÇ¹¥»÷¼ÓËÙ'+#13+
                                      '¹¥»÷ËÙ¶ÈÊÇ¶¾Îï¶ã±Ü'+#13+
                                      '×÷ÓÃÑÓÊ±ÊÇÖÐ¶¾»Ö¸´'+#13+
                                      '×°ÅäÍâ¹Û(Shape)=ÈËÎï×°ÅäÍâ¹Û£¬¸ÃÊýÖµÏàÍ¬µÄÎïÆ·£¬ÔÚÈËÎïÍâ¹ÛÉÏ¿´Ò²ÏàÍ¬'+#13+
                                      'ÎïÆ·Íâ¹Û(Looks)=¸ÃÊýÖµÏàÍ¬µÄÎïÆ·£¬ÔÚÎïÆ·À¸ÖÐÍâ¹ÛÒ²ÏàÍ¬'+#13+
                                      '³Ö¾Ã¶È(DuraMax)=ÒÔ1000Îªµ¥Î»£¬1000¼´Îª1¸öµãµÄ³Ö¾Ã'+#13+
                                      '£«¹¥»÷ËÙ¶È(Ac)=£¨½¨ÒéÖµ£º0~10£©'+#13+
                                      '¶¾Îï¶ã±Ü(Ac2)=£¨1£½10%£¬2£½20%£¬¡­£¬½¨ÒéÖµ£º0~100£©'+#13+
                                      '£­¹¥»÷ËÙ¶È(Mac)=£¨½¨ÒéÖµ£º0~10£©'+#13+
                                      'ÖÐ¶¾»Ö¸´(Mac2)=£¨1£½10%£¬2£½20%£¬¡­£¬½¨ÒéÖµ£º0~100£©'+#13+
                                      '×îµÍÓë×î¸ß¹¥»÷Á¦(Dc¡¢Dc2)=£¨½¨ÒéÖµ£º0~200£©'+#13+
                                      '×îµÍÓë×î¸ßÄ§·¨Á¦(Mc¡¢Mc2)=£¨½¨ÒéÖµ£º0~200£©'+#13+
                                      '×îµÍÓë×î¸ßµÀÊõÁ¦(Sc¡¢Sc2)=£¨½¨ÒéÖµ£º0~200£©'+#13+
                                      'ÐèÒªµÈ¼¶(Need)Óë¸½¼ÓÌõ¼þ(NeedLevel)=ÐèÒªÅäºÏÊ¹ÓÃ£¬Need=0Ê±NeedLevelÎªËùÐèµÈ¼¶£»Need=1Ê±NeedLevelÎªËùÐè¹¥»÷Á¦£»Need=2Ê±NeedLevelÎªËùÐèÄ§·¨Á¦£»Need=3Ê±NeedLevelÎªËùÐèµÀÊõÁ¦';

        end;
    end;
    25: begin
        if FilterItems('24') then begin
          ListBoxItemsHint.Clear;
          MemoItemsHint.Clear;
          ListBoxItemsHint.Items.Add('0=Ìú¡¢Òø¡¢ÏÄÆÕ¶ù¡¢±ÜÐ°¡¢ÒøÓòÊÖïí');
          ListBoxItemsHint.Items.Add('124=¼ÇÒäÊÖïí');
          MemoItemsHint.Lines.Text := '¹¥»÷¼ÓËÙÊÇ×¼È·'+#13+
                                      '×÷ÓÃÑÓÊ±ÊÇÃô½Ý'+#13+
                                      '×°ÅäÍâ¹Û(Shape)=ÈËÎï×°ÅäÍâ¹Û£¬¸ÃÊýÖµÏàÍ¬µÄÎïÆ·£¬ÔÚÈËÎïÍâ¹ÛÉÏ¿´Ò²ÏàÍ¬'+#13+
                                      'ÎïÆ·Íâ¹Û(Looks)=¸ÃÊýÖµÏàÍ¬µÄÎïÆ·£¬ÔÚÎïÆ·À¸ÖÐÍâ¹ÛÒ²ÏàÍ¬'+#13+
                                      '³Ö¾Ã¶È(DuraMax)=ÒÔ1000Îªµ¥Î»£¬1000¼´Îª1¸öµãµÄ³Ö¾Ã'+#13+
                                      '×¼È·(Ac2)=£¨½¨ÒéÖµ£º0~100£©'+#13+
                                      'Ãô½Ý(Mac2)=£¨½¨ÒéÖµ£º0~100£©'+#13+
                                      '×îµÍÓë×î¸ß¹¥»÷Á¦(Dc¡¢Dc2)=£¨½¨ÒéÖµ£º0~200£©'+#13+
                                      '×îµÍÓë×î¸ßÄ§·¨Á¦(Mc¡¢Mc2)=£¨½¨ÒéÖµ£º0~200£©'+#13+
                                      '×îµÍÓë×î¸ßµÀÊõÁ¦(Sc¡¢Sc2)=£¨½¨ÒéÖµ£º0~200£©'+#13+
                                      'ÐèÒªµÈ¼¶(Need)Óë¸½¼ÓÌõ¼þ(NeedLevel)=ÐèÒªÅäºÏÊ¹ÓÃ£¬Need=0Ê±NeedLevelÎªËùÐèµÈ¼¶£»Need=1Ê±NeedLevelÎªËùÐè¹¥»÷Á¦£»Need=2Ê±NeedLevelÎªËùÐèÄ§·¨Á¦£»Need=3Ê±NeedLevelÎªËùÐèµÀÊõÁ¦';

        end;
    end;
    26: begin
        if FilterItems('25') then begin
          ListBoxItemsHint.Clear;
          MemoItemsHint.Clear;
          ListBoxItemsHint.Items.Add('0=³¬¼¶À¶¶¾');
          ListBoxItemsHint.Items.Add('1=»ÒÉ«Ò©·Û');
          ListBoxItemsHint.Items.Add('2=»ÆÉ«Ò©·Û');
          ListBoxItemsHint.Items.Add('5=»¤Éí·û');
        end;
    end;
    27: begin
        if FilterItems('26') then begin
          ListBoxItemsHint.Clear;
          MemoItemsHint.Clear;
          ListBoxItemsHint.Items.Add('0=ÆÕÍ¨ÐÍ');
          ListBoxItemsHint.Items.Add('126=Æíµ»ÊÖïí');
          ListBoxItemsHint.Items.Add('131=ÉñÃØÊÖïí');
          ListBoxItemsHint.Items.Add('134=À¼»¨ÊÖïí');
          ListBoxItemsHint.Items.Add('137=µÐÄÑÊÖïí');
          MemoItemsHint.Lines.Text := 'HPÉÏÏÞºÍ¹¥»÷¼ÓËÙÊÇ·ÀÓùÉÏÏÞºÍÏÂÏÞ'+#13+
                                      'MPÉÏÏÞºÍ×÷ÓÃÑÓÊ±ÊÇÄ§ÓùÉÏÏÞºÍÏÂÏÞ'+#13+
                                      '×°ÅäÍâ¹Û(Shape)=ÈËÎï×°ÅäÍâ¹Û£¬¸ÃÊýÖµÏàÍ¬µÄÎïÆ·£¬ÔÚÈËÎïÍâ¹ÛÉÏ¿´Ò²ÏàÍ¬'+#13+
                                      'ÎïÆ·Íâ¹Û(Looks)=¸ÃÊýÖµÏàÍ¬µÄÎïÆ·£¬ÔÚÎïÆ·À¸ÖÐÍâ¹ÛÒ²ÏàÍ¬'+#13+
                                      '³Ö¾Ã¶È(DuraMax)=ÒÔ1000Îªµ¥Î»£¬1000¼´Îª1¸öµãµÄ³Ö¾Ã'+#13+
                                      '×îµÍÓë×î¸ß¹¥·À(Ac¡¢Ac2)=£¨½¨ÒéÖµ£º0~200£©'+#13+
                                      '×îµÍÓë×î¸ßÄ§Óù(Mac¡¢Mac2)=£¨½¨ÒéÖµ£º0~200£©'+#13+
                                      '×îµÍÓë×î¸ß¹¥»÷Á¦(Dc¡¢Dc2)=£¨½¨ÒéÖµ£º0~200£©'+#13+
                                      '×îµÍÓë×î¸ßÄ§·¨Á¦(Mc¡¢Mc2)=£¨½¨ÒéÖµ£º0~200£©'+#13+
                                      '×îµÍÓë×î¸ßµÀÊõÁ¦(Sc¡¢Sc2)=£¨½¨ÒéÖµ£º0~200£©'+#13+
                                      'ÐèÒªµÈ¼¶(Need)Óë¸½¼ÓÌõ¼þ(NeedLevel)=ÐèÒªÅäºÏÊ¹ÓÃ£¬Need=0Ê±NeedLevelÎªËùÐèµÈ¼¶£»Need=1Ê±NeedLevelÎªËùÐè¹¥»÷Á¦£»Need=2Ê±NeedLevelÎªËùÐèÄ§·¨Á¦£»Need=3Ê±NeedLevelÎªËùÐèµÀÊõÁ¦';

        end;
    end;
    28:begin
      if FilterItems('27') then begin
          ListBoxItemsHint.Clear;
          MemoItemsHint.Clear;
          MemoItemsHint.Lines.Text := '¹¥»÷¼ÓËÙÊÇ×¼È·'+#13+
                                      '×÷ÓÃÑÓÊ±ÊÇÃô½Ý'+#13+
                                      '×°ÅäÍâ¹Û(Shape)=ÈËÎï×°ÅäÍâ¹Û£¬¸ÃÊýÖµÏàÍ¬µÄÎïÆ·£¬ÔÚÈËÎïÍâ¹ÛÉÏ¿´Ò²ÏàÍ¬'+#13+
                                      'ÎïÆ·Íâ¹Û(Looks)=¸ÃÊýÖµÏàÍ¬µÄÎïÆ·£¬ÔÚÎïÆ·À¸ÖÐÍâ¹ÛÒ²ÏàÍ¬'+#13+
                                      '³Ö¾Ã¶È(DuraMax)=ÒÔ1000Îªµ¥Î»£¬1000¼´Îª1¸öµãµÄ³Ö¾Ã'+#13+
                                      '×¼È·(Ac2)=£¨½¨ÒéÖµ£º0~100£©'+#13+
                                      'Ãô½Ý(Mac2)=£¨½¨ÒéÖµ£º0~100£©';
      end;
    end;
    29:begin
      if FilterItems('28') then begin
          ListBoxItemsHint.Clear;
          MemoItemsHint.Clear;
          MemoItemsHint.Lines.Text := '×÷ÓÃÑÓÊ± Îª ÐÒÔË '+#13+
                                      '¹¥»÷¼ÓËÙ Îª ×¼È·'+#13+
                                      '×°ÅäÍâ¹Û(Shape)=ÈËÎï×°ÅäÍâ¹Û£¬¸ÃÊýÖµÏàÍ¬µÄÎïÆ·£¬ÔÚÈËÎïÍâ¹ÛÉÏ¿´Ò²ÏàÍ¬'+#13+
                                      'Ô´¶¯Á¦(0-125) »÷É±¶ÔÊÖÊ±£¬¶ÔÊÖ±¬ÂÊÔö¼Ó'+#13+
                                      'ÎïÆ·Íâ¹Û(Looks)=¸ÃÊýÖµÏàÍ¬µÄÎïÆ·£¬ÔÚÎïÆ·À¸ÖÐÍâ¹ÛÒ²ÏàÍ¬'+#13+
                                      '³Ö¾Ã¶È(DuraMax)=ÒÔ1000Îªµ¥Î»£¬1000¼´Îª1¸öµãµÄ³Ö¾Ã'+#13+
                                      '×¼È·(Ac2)=£¨½¨ÒéÖµ£º0~100£©'+#13+
                                      '×çÖä(Mac)=£¨½¨ÒéÖµ£º0~100£©'+#13+
                                      'ÐÒÔË(Mac2)=£¨½¨ÒéÖµ£º0~100£©';
      end;
    end;
    30: begin
      if FilterItems('29') then begin
          ListBoxItemsHint.Clear;
          MemoItemsHint.Clear;
          MemoItemsHint.Lines.Text := '×÷ÓÃÑÓÊ± Îª ÐÒÔË '+#13+
                                      '¹¥»÷¼ÓËÙ Îª Ãô½Ý'+#13+
                                      '×°ÅäÍâ¹Û(Shape)=ÈËÎï×°ÅäÍâ¹Û£¬¸ÃÊýÖµÏàÍ¬µÄÎïÆ·£¬ÔÚÈËÎïÍâ¹ÛÉÏ¿´Ò²ÏàÍ¬'+#13+
                                      'Ô´¶¯Á¦(0-125) »÷É±¶ÔÊÖÊ±£¬¶ÔÊÖ±¬ÂÊÔö¼Ó'+#13+
                                      'ÎïÆ·Íâ¹Û(Looks)=¸ÃÊýÖµÏàÍ¬µÄÎïÆ·£¬ÔÚÎïÆ·À¸ÖÐÍâ¹ÛÒ²ÏàÍ¬'+#13+
                                      '³Ö¾Ã¶È(DuraMax)=ÒÔ1000Îªµ¥Î»£¬1000¼´Îª1¸öµãµÄ³Ö¾Ã'+#13+
                                      'Ãô½Ý(Ac2)=£¨½¨ÒéÖµ£º0~100£©'+#13+
                                      '×çÖä(Mac)=£¨½¨ÒéÖµ£º0~100£©'+#13+
                                      'ÐÒÔË(Mac2)=£¨½¨ÒéÖµ£º0~100£©';
      end;
    end;
    31: begin
        if FilterItems('30') then begin
          ListBoxItemsHint.Clear;
          ListBoxItemsHint.Items.Add('Source=0 ËæÊ±¼ä¼õ³Ö¾Ã');//20090416
          MemoItemsHint.Clear;
          MemoItemsHint.Lines.Text := 'Ô´¶¯Á¦ÊÇÐÒÔË'+#13+
                                      'HPÉÏÏÞºÍ¹¥»÷¼ÓËÙÊÇ·ÀÓùÉÏÏÞºÍÏÂÏÞ'+#13+
                                      'MPÉÏÏÞºÍ×÷ÓÃÑÓÊ±ÊÇÄ§ÓùÉÏÏÞºÍÏÂÏÞ'+#13+#13+
                                      'Anicount=202 ÇòÍõÑ«ÕÂ(Âé±Ô¡¢»¤Éí¡¢ÖØÉúÊôÐÔ)';

        end;
    end;
    32: begin
        if FilterItems('31') then begin
          ListBoxItemsHint.Clear;
          MemoItemsHint.Clear;
          ListBoxItemsHint.Items.Add('98=´òÀ¦³¬Ç¿½ð´´Ò©');
          ListBoxItemsHint.Items.Add('99=´òÀ¦³¬Ç¿Ä§·¨Ò©');
          ListBoxItemsHint.Items.Add('100=³¬¼¶½ð´´Ò©');
          ListBoxItemsHint.Items.Add('101=³¬¼¶Ä§·¨Ò©');
          ListBoxItemsHint.Items.Add('102=½ð´´Ò©£¨Ð¡£©°ü');
          ListBoxItemsHint.Items.Add('103=Ä§·¨Ò©£¨Ð¡£©°ü');
          ListBoxItemsHint.Items.Add('104=½ð´´Ò©£¨ÖÐ£©°ü');
          ListBoxItemsHint.Items.Add('105=Ä§·¨Ò©£¨ÖÐ£©°ü');
          ListBoxItemsHint.Items.Add('106=µØÀÎÌÓÍÑ¾í°ü');
          ListBoxItemsHint.Items.Add('107=Ëæ»ú´«ËÍ¾í°ü');
          ListBoxItemsHint.Items.Add('108=»Ø³Ç¾í°ü');
          ListBoxItemsHint.Items.Add('109=ÐÐ»á»Ø³Ç¾í°ü');
          ListBoxItemsHint.Items.Add('110=³ïÂë°ü');
          ListBoxItemsHint.Items.Add('111=³¬¼¶·ûÉí·û');
          ListBoxItemsHint.Items.Add('112=Ñ©Ëª°ü');
          ListBoxItemsHint.Items.Add('113=ºìÄ¾°ü');
          ListBoxItemsHint.Items.Add('114=À¶Ä¾°ü');
          ListBoxItemsHint.Items.Add('115=´òÀ¦³¬ºì¶¾');
          ListBoxItemsHint.Items.Add('116=´òÀ¦³¬À¶¶¾');
          MemoItemsHint.Lines.Text := '×°ÅäÍâ¹ÛÊÇÒ©Æ·½âÀ¦Âë'+#13+
                                      'AnicountÊÇ½Å±¾´¥·¢Âë';
        end;
    end;
    33:begin
        if FilterItems('36') then begin
          ListBoxItemsHint.Clear;
          MemoItemsHint.Clear;
          ListBoxItemsHint.Items.Add('1=ÊéÐÅ¡¢»ÒÄ¾¡¢ºìÄ¾¡¢À¶Ä¾µÈ');
        end;
    end;
    34: begin
        if FilterItems('40') then begin
          ListBoxItemsHint.Clear;
          MemoItemsHint.Clear;
        end;
    end;
    35: begin
        if FilterItems('41') then begin
          ListBoxItemsHint.Clear;
          MemoItemsHint.Clear;
          ListBoxItemsHint.Items.Add('0=ÃüÔËÖ®Êé¡¢½á»éÖ¤Êé');
          ListBoxItemsHint.Items.Add('1=Ñª½£¿é');
        end;
    end;
    36: begin
        if FilterItems('42') then begin
          ListBoxItemsHint.Clear;
          MemoItemsHint.Clear;
        end;
    end;
    37: begin
        if FilterItems('43') then begin
          ListBoxItemsHint.Clear;
          MemoItemsHint.Clear;
        end;
    end;
    38: begin
        if FilterItems('44') then begin
          ListBoxItemsHint.Clear;
          MemoItemsHint.Clear;
          ListBoxItemsHint.Items.Add('0=ÎÖÂêºÅ½Ç');
          ListBoxItemsHint.Items.Add('1=×æÂêÍ·Ïñ¡¢Ë®¾§µÈ');

          MemoItemsHint.Lines.Text := '248=¶·×ªÁéµ¤'+#13+
                                      '249=Ò»¼¶¼ûÏ°¾íÖá'+#13+
                                      '250=¶þ¼¶¼ûÏ°¾íÖá'+#13+
                                      '251=Èý¼¶¼ûÏ°¾íÖá'+#13+
                                      '252=¼ûÏ°ÉñÃØ¾íÖá'+#13+
                                      '253=³ýÄ§ÁéÃ½(Æ·ÖÊ£º±£Áô[Reserved]²»ÄÜ´óÓÚ228)'+#13+
                                      '254=ÑòÆ¤¾í'+#13+
                                      '255=ÉñÃØ¾íÖá';
        end;
    end;
    39: begin
        if FilterItems('45') then begin
          ListBoxItemsHint.Clear;
          MemoItemsHint.Clear;
          ListBoxItemsHint.Items.Add('0=°×¾Õ»¨');
          ListBoxItemsHint.Items.Add('2=·ðÅÆ');
          ListBoxItemsHint.Items.Add('6=÷»×Ó');
        end;
    end;
    40: begin
        if FilterItems('46') then begin
          ListBoxItemsHint.Clear;
          MemoItemsHint.Clear;
          ListBoxItemsHint.Items.Add('0=Æ¾Ö¤');
          ListBoxItemsHint.Items.Add('1=³ïÂë¡¢Ò©¼ÁÊ¦µÄÐÅµÈ');
        end;
    end;
    41: begin
        if FilterItems('47') then begin
          ListBoxItemsHint.Clear;
          MemoItemsHint.Clear;
          MemoItemsHint.Lines.Text := 'Source=127Ê±,¿ÉÒÔÔö¼Ó»ðÁúÖ®ÐÄµÄÅ­Æø(Reserved*100=Ôö¼ÓÅ­ÆøÖµ)';
        end;
    end;
    42: begin
      if FilterItems('48') then begin
        ListBoxItemsHint.Clear;
        MemoItemsHint.Clear;
        MemoItemsHint.Lines.Text := 'Reserved 0=¾É±¦Ïä'+#13+
                                    '         1=ÐÂ±¦Ïä'+#13+
                                    '         2-¾ÅÖÜÄê±¦Ïä'+#13+#13+
                                    'Source   Ïä×Ó¶ÔÓ¦µÄÅäÖÃÎÄ¼þÃû'+#13+#13+
                                    'AniCount ¶ÔÓ¦Ô¿³×µÄShape';
      end;
    end;
    43: begin
      if FilterItems('49') then begin
        ListBoxItemsHint.Clear;
        MemoItemsHint.Clear;
        MemoItemsHint.Lines.Text := 'Reserved ±íÊ¾¹ºÂòËùÐèÔÚµÄÔª±¦Êý[Ö»ÄÜÉèÖÃ0-255]'+#13+#13+
                                    'Anicount ±íÊ¾Ò»´Î¿ÉÒÔ¹ºÂòµÄÎïÆ·¸öÊý(Ìì´ÍÀà³ýÍâ)'+#13+#13+
                                    'Shape    ¶ÔÓ¦±¦ÏäµÄAniCount,²Å¿É´ò¿ª±¦Ïä';
      end;
    end;
    44: begin
        if FilterItems('50') then begin
          ListBoxItemsHint.Clear;
          MemoItemsHint.Clear;
        end;
    end;
    45: begin
        if FilterItems('51') then begin
          ListBoxItemsHint.Clear;
          MemoItemsHint.Clear;
          ListBoxItemsHint.Items.Add('¾ÛÁéÖé ³Ö¾ÃÖµ1=1W');
          ListBoxItemsHint.Items.Add('ÄÚ¹¦Öé ³Ö¾ÃÖµ1=1000');
          ListBoxItemsHint.Items.Add('       ³Ö¾ÃÖµ1-65535');
          ListBoxItemsHint.Items.Add('Áé  Öé ³Ö¾ÃÖµ1=1W');
          ListBoxItemsHint.Items.Add('NeedLevel--Îª¿ÉÊ¹ÓÃ¾Û¼¯ÎïÆ·µÄµÈ¼¶');
          ListBoxItemsHint.Items.Add('Need--0-µÈ¼¶´ïµ½NeedLevelÖµºó¿ÉÊ¹ÓÃ');
          ListBoxItemsHint.Items.Add('      1-µÈ¼¶Ð¡ÓÚNeedLevelÖµÊ±¿ÉÊ¹ÓÃ');
          MemoItemsHint.Lines.Text := '×°ÅäÍâ¹Û=0 ¾ÛÁéÖé(¾Û¼¯¾­Ñé) Anicount=1 ´ú±íÌìÊý'+#13+#13+
                                      '×°ÅäÍâ¹Û=1 ÄÚ¹¦Öé(¾Û¼¯ÄÚ¹¦¾­Ñé)'+#13+#13+
                                      '×°ÅäÍâ¹Û=2 Ó¢ÐÛ¾ÛÁéÖé(¾Û¼¯¾­Ñé,Ë«»÷Ó¢ÐÛµÃ¾­Ñé)'+#13+#13+
                                      '×°ÅäÍâ¹Û=3 Ö÷Ô×ÁéÖé(ÎÞÐè¾Û¼¯,ÎÞÊ±¼äÏÞÖÆ,Ë«»÷Ó¢ÐÛµÃ¾­Ñé,²»ÊÜÓ¢ÐÛµÈ¼¶ÉÏÏÞÏÞÖÆ) Anicount×Ö¶Î´ú±íÊ¹ÓÃËùÐèµÄÔª±¦Êý Reserved=255(ÆôÓÃµÈ¼¶ÏÞÖÆ·ÖÅä¿ØÖÆ)';
        end;
    end;
    46: begin
        if FilterItems('52') then begin
          ListBoxItemsHint.Clear;
          MemoItemsHint.Clear;
        end;
    end;
    47: begin
        if FilterItems('53') then begin
          ListBoxItemsHint.Clear;
          MemoItemsHint.Clear;
        end;
    end;
    48: begin
        if FilterItems('54') then begin
          ListBoxItemsHint.Clear;
          MemoItemsHint.Clear;
        end;
    end;
    49:begin
        if FilterItems('60') then begin
          ListBoxItemsHint.Clear;
          MemoItemsHint.Clear;
          ListBoxItemsHint.Items.Add('DC1ºÍDC2Îª¾Æ¾«¶È·¶Î§(Äð¾ÆÎÞÐ§)');
          MemoItemsHint.Lines.Text := 'Anicount 1-ÆÕÍ¨¾Æ 2-Ò©¾Æ'+#13+
                                      '×°ÅäÍâ¹Û(Shape)=¾ÆÇú(Shape),Äð¾ÆÊ±'+#13+
                                      '²Å»áÓÐ¿ÉÄÜ»ñµÃ¶ÔÓ¦µÄ¾ÆÇú'+#13+
                                      'NeedLevel--Ò©¾ÆÊ¹ÓÃËùÐèµÄ¾ÆÁ¿Öµ'+#13+#13+
                                      'Shape  0--ÉÕ¾Æ'+#13+
                                      '       1-7--ÆÕÍ¨¾Æ'+#13+
                                      '       8--»¢¹Ç¾Æ'+#13+
                                      '       9--½ð²­¾Æ'+#13+
                                      '       10--»îÂö¾Æ'+#13+
                                      '       11--Ðþ²Î¾Æ'+#13+
                                      '       12--Éßµ¨¾Æ'+#13+
                                      '       13--×í°Ë´ò'+#13+
                                      '       14--ºÎÊ×ÑøÆø¾Æ'+#13+
                                      '       15--ºÎÊ×ÄýÉñ¾Æ'+#13+
                                      '       16--ÅàÔª¾Æ';
        end;
    end;
    50: begin
        if FilterItems('62') then begin
          ListBoxItemsHint.Clear;
          MemoItemsHint.Clear;
        end;
    end;
    51: begin
        if FilterItems('63') then begin
          ListBoxItemsHint.Clear;
          MemoItemsHint.Clear;
        end;
    end;
    52: begin
        if FilterItems('64') then begin
          ListBoxItemsHint.Clear;
          MemoItemsHint.Clear;
        end;
    end;
  end;
end;
//±¸·Ý¿â
procedure TFrmMain.BtnMagicBaseBakClick(Sender: TObject);
begin
  SaveDialog1.Filter := 'Êý¾Ý¿â(*.DB)|*.DB';
  if Sender = BtnMagicBaseBak then begin
     if not FileExists(sGameDirectory + 'Mud2\DB\Magic.DB') then begin
       FrmMain.bsSkinMessage1.MessageDlg('ÔÚÄãµÄ°æ±¾Ä¿Â¼ÏÂÃ»ÓÐÕÒµ½Ä§·¨Êý¾Ý¿â!!',mtInformation,[mbOK],0);
       Exit;
     end;
     if SaveDialog1.Execute then
     CopyFile(PChar(sGameDirectory + 'Mud2\DB\Magic.DB'),PChar(SaveDialog1.FileName),False);
  end;
  if Sender = BtnMobBaseBak then begin
     if not FileExists(sGameDirectory + 'Mud2\DB\Monster.DB') then begin
       FrmMain.bsSkinMessage1.MessageDlg('ÔÚÄãµÄ°æ±¾Ä¿Â¼ÏÂÃ»ÓÐÕÒµ½¹ÖÎïÊý¾Ý¿â!!',mtInformation,[mbOK],0);
       Exit;
     end;
     if SaveDialog1.Execute then
     CopyFile(PChar(sGameDirectory + 'Mud2\DB\Monster.DB'),PChar(SaveDialog1.FileName),False);
  end;
  if Sender = BtnItemsBaseBak then begin
     if not FileExists(sGameDirectory + 'Mud2\DB\StdItems.DB') then begin
       FrmMain.bsSkinMessage1.MessageDlg('ÔÚÄãµÄ°æ±¾Ä¿Â¼ÏÂÃ»ÓÐÕÒµ½ÎïÆ·Êý¾Ý¿â!!',mtInformation,[mbOK],0);
       Exit;
     end;
     if SaveDialog1.Execute then
     CopyFile(PChar(sGameDirectory + 'Mud2\DB\StdItems.DB'),PChar(SaveDialog1.FileName),False);
  end;
  if Sender = BtnFongHaoBaseBak then begin
     if not FileExists(sGameDirectory + 'Mud2\DB\FengHaos.DB') then begin
       FrmMain.bsSkinMessage1.MessageDlg('ÔÚÄãµÄ°æ±¾Ä¿Â¼ÏÂÃ»ÓÐÕÒµ½³ÆºÅÊý¾Ý¿â!!',mtInformation,[mbOK],0);
       Exit;
     end;
     if SaveDialog1.Execute then
     CopyFile(PChar(sGameDirectory + 'Mud2\DB\FengHaos.DB'),PChar(SaveDialog1.FileName),False);
  end;
end;
//»Ö¸´¿â
procedure TFrmMain.BtnMagicBaseRestoreClick(Sender: TObject);
begin
  SaveDialog1.Filter := 'Êý¾Ý¿â(*.DB)|*.DB';
  OpenDialog1.Filter := 'Êý¾Ý¿â(*.DB)|*.DB';
  if Sender = BtnMagicBaseRestore then begin
     if OpenDialog1.Execute then
     if bsSkinMessage1.MessageDlg('È·¶¨ËùÑ¡ÎÄ¼þÊÇÄãËùÐèµÄÊý¾Ý¿âÂð£¿'+#13+'(ËùÑ¡µÄ¿â½«Ìæ´úÏÖÓÐµÄ¿â)' ,mtInformation,[mbYes,mbNo],0) = ID_NO then Exit;
     FrmDM.TableMagic.Active := False;
     CopyFile(PChar(OpenDialog1.FileName),PChar(sGameDirectory + 'Mud2\DB\Magic.DB'),False);
     FrmDM.TableMagic.Active := True;
  end;
  if Sender = BtnMobBaseRestore then begin
     if OpenDialog1.Execute then
     if bsSkinMessage1.MessageDlg('È·¶¨ËùÑ¡ÎÄ¼þÊÇÄãËùÐèµÄÊý¾Ý¿âÂð£¿'+#13+'(ËùÑ¡µÄ¿â½«Ìæ´úÏÖÓÐµÄ¿â)' ,mtInformation,[mbYes,mbNo],0) = ID_NO then Exit;
     FrmDM.TableMonster.Active := False;
     CopyFile(PChar(OpenDialog1.FileName),PChar(sGameDirectory + 'Mud2\DB\Monster.DB'),False);
     FrmDM.TableMonster.Active := True;
  end;
  if Sender = BtnItemsBaseRestore then begin
     if OpenDialog1.Execute then
     if bsSkinMessage1.MessageDlg('È·¶¨ËùÑ¡ÎÄ¼þÊÇÄãËùÐèµÄÊý¾Ý¿âÂð£¿'+#13+'(ËùÑ¡µÄ¿â½«Ìæ´úÏÖÓÐµÄ¿â)' ,mtInformation,[mbYes,mbNo],0) = ID_NO then Exit;
     FrmDM.TableStdItems.Active := False;
     CopyFile(PChar(OpenDialog1.FileName),PChar(sGameDirectory + 'Mud2\DB\StdItems.DB'),False);
     FrmDM.TableStdItems.Active := True;
  end;
  if Sender = BtnFongHaoRestore then begin
     if OpenDialog1.Execute then
     if bsSkinMessage1.MessageDlg('È·¶¨ËùÑ¡ÎÄ¼þÊÇÄãËùÐèµÄÊý¾Ý¿âÂð£¿'+#13+'(ËùÑ¡µÄ¿â½«Ìæ´úÏÖÓÐµÄ¿â)' ,mtInformation,[mbYes,mbNo],0) = ID_NO then Exit;
     FrmDM.TableStdItems.Active := False;
     CopyFile(PChar(OpenDialog1.FileName),PChar(sGameDirectory + 'Mud2\DB\FengHaos.DB'),False);
     FrmDM.TableStdItems.Active := True;
  end;
end;
{******************************************************************************}
//ÒÔÏÂÊÇÑÕÉ«ÅäÖÃÆ÷´úÂë
function GetRGB(c256: Byte): TColor;
begin
  Move(ColorArray, ColorTable, SizeOf(ColorArray));
  Result := RGB(ColorTable[c256].rgbRed, ColorTable[c256].rgbGreen, ColorTable[c256].rgbBlue);
end;

procedure TFrmMain.TrackEditColor1Change(Sender: TObject);
begin
  RzLabel1.Color := GetRGB(TrackEditColor1.Value);
end;

procedure TFrmMain.TrackEditColor2Change(Sender: TObject);
begin
   RzLabel1.Font.Color := GetRGB(TrackEditColor2.Value);
end;

procedure TFrmMain.FormShow(Sender: TObject);
var
  sProductName: string;
  sVersion: string;
  sBbsSite: string;
begin
  Decode(g_sProductName, sProductName);
  Decode(g_sVersion, sVersion);
  Decode(g_sBbsSite, sBbsSite);
  LabelProductName.Caption := sProductName;
  LabelVersion.Caption := sVersion;
  bsSkinLinkLabel1.Caption := sBbsSite;
  bsSkinLinkLabel1.URL := sBbsSite;
  bsSkinPageControl1.ActivePage:= bsSkinTabSheet1;
end;
{******************************************************************************}
//ÎÄ±¾µ¼³öº¯Êý
Function TFrmMain.ExportTxt(DBGridEh:TDBGrideh;Var TextName:string):BooLean;
Var F:TextFile;
    I:Integer;
    LStrField:String;
    Field: Array of String;
begin
   if DBGridEh.DataSource.DataSet.IsEmpty then
      Raise Exception.Create('Ã»ÓÐÊý¾Ý¼ÇÂ¼ÎÞÐëµ¼³ö£¡');
   DBGridEh.DataSource.DataSet.First;
   SetLength(Field,DBGridEh.DataSource.DataSet.FieldCount);
   if FileExists(TextName) then
      if bsSkinMessage1.MessageDlg('¸ÃÎÄ¼þÒÑ´æÔÚ,ÊÇ·ñ¸²¸Ç',mtInformation,[mbOK,mbCancel],0) = IdCancel then Abort;
   DBGridEh.DataSource.DataSet.DisableControls;
   AssignFile(F,TextName);
   ReWrite(F);
   try
     try
       While Not DBGridEh.DataSource.DataSet.Eof do begin
         LStrField:='';
         For I:=0 to DBGridEh.DataSource.DataSet.FieldCount-1 do begin
           IF DBGridEh.Columns[I].Visible then  Field[I]:=Trim(DBGridEh.DataSource.DataSet.Fields[I].AsString)+';';
           LStrField:=LStrField+Trim(Field[I]);
         end;
         WriteLn(F,LStrField);
         DBGridEh.DataSource.DataSet.Next;
       end;
       Result:=True;
     Except
       Result:=False;
     end;
   finally
     CloseFile(F);
     DBGridEh.DataSource.DataSet.EnableControls;
   end;
end;
//ÎÄ±¾µ¥ÐÐµ¼³ö
Function TFrmMain.ExportTxt1(DBGridEh:TDBGrideh;Var TextName:string):BooLean;
var J:integer;
    S:string;
    F:TextFile;
begin
  if DBGridEh.SelectedField = nil then
    Raise Exception.Create('Ã»ÓÐÊý¾Ý¼ÇÂ¼ÎÞÐëµ¼³ö£¡');

   AssignFile(F,TextName);
   ReWrite(F);
   try
     try
      with DBGridEh.DataSource.DataSet do begin
        for J := 0 to DBGridEh.FieldCount-1 do begin
          S:= S + DBGridEh.Fields[J].AsString+';';
        end;
        WriteLn(F,S);
      end;
     Result:=True;
     Except
       Result:=False;
     end;
   finally
     CloseFile(F);
   end;
end;

procedure TFrmMain.bsSkinButton7Click(Sender: TObject);
var
  Filename: STRING;
begin
  if FrmDM.TableStdItems.RecordCount = 0 then
  Begin
   //Application.MessageBox(#13'Ã»ÓÐ¿Éµ¼³öµÄÊý¾Ý,Çë¸´ºË!!!', MBInfo, 16+MB_OK);
   bsSkinMessage1.MessageDlg('Ã»ÓÐ¿Éµ¼³öµÄÊý¾Ý,Çë¸´ºË!!!',mtInformation,[mbOK],0);
   Exit;
  end;
  SaveDialog1.Filter:='ÎÄ±¾ÎÄ¼þ(*.txt)|*.txt';
  if Not SaveDialog1.Execute then Exit;
  Filename:=SaveDialog1.FileName ;
  if ExportTxt(ItemsDBGrid,Filename) then
    bsSkinMessage1.MessageDlg('ÎïÆ·Êý¾Ýµ¼³ö³É¹¦!!!',mtInformation,[mbOK],0);//Application.MessageBox('ÎïÆ·Êý¾Ýµ¼³ö³É¹¦!!!', MBInfo, 64+MB_OK);
end;

procedure TFrmMain.N5Click(Sender: TObject);
var
  Filename: STRING;
begin
  IF ItemsDBGrid.DataSource=nil then Exit;
  SaveDialog1.Filter:='ÎÄ±¾ÎÄ¼þ(*.txt)|*.txt';
  if Not SaveDialog1.Execute then Exit;
  Filename:=SaveDialog1.FileName ;

  case bsSkinPageControl2.TabIndex of
    0:begin
       if FrmDM.TableMagic.RecordCount = 0 then
          Begin
           //Application.MessageBox(#13'Ã»ÓÐ¿Éµ¼³öµÄÊý¾Ý,Çë¸´ºË!!!', MBInfo, 16+MB_OK);
           bsSkinMessage1.MessageDlg('Ã»ÓÐ¿Éµ¼³öµÄÊý¾Ý,Çë¸´ºË!!!',mtInformation,[mbOK],0);
           Exit;
          end;
       if ExportTxt1(MagicDBGrid,Filename) then bsSkinMessage1.MessageDlg('¼¼ÄÜÊý¾Ýµ¼³ö³É¹¦!!!',mtInformation,[mbOK],0);//Application.MessageBox('¼¼ÄÜÊý¾Ýµ¼³ö³É¹¦!!!', MBInfo, 64+MB_OK);
      end;
    1:begin
        if FrmDM.TableMonster.RecordCount = 0 then
          Begin
           //Application.MessageBox(#13'Ã»ÓÐ¿Éµ¼³öµÄÊý¾Ý,Çë¸´ºË!!!', MBInfo, 16+MB_OK);
           bsSkinMessage1.MessageDlg('Ã»ÓÐ¿Éµ¼³öµÄÊý¾Ý,Çë¸´ºË!!!',mtInformation,[mbOK],0);
           Exit;
          end;
       if ExportTxt1(MobDBGrid,Filename) then
          bsSkinMessage1.MessageDlg('Îï¹ÖÊý¾Ýµ¼³ö³É¹¦!!!',mtInformation,[mbOK],0);//Application.MessageBox('Îï¹ÖÊý¾Ýµ¼³ö³É¹¦!!!', MBInfo, 64+MB_OK);
      end;
    2:begin
        if FrmDM.TableStdItems.RecordCount = 0 then
          Begin
           //Application.MessageBox(#13'Ã»ÓÐ¿Éµ¼³öµÄÊý¾Ý,Çë¸´ºË!!!', MBInfo, 16+MB_OK);
           bsSkinMessage1.MessageDlg('Ã»ÓÐ¿Éµ¼³öµÄÊý¾Ý,Çë¸´ºË!!!',mtInformation,[mbOK],0);
           Exit;
          end;
       if ExportTxt1(ItemsDBGrid,Filename) then
          bsSkinMessage1.MessageDlg('ÎïÆ·Êý¾Ýµ¼³ö³É¹¦!!!',mtInformation,[mbOK],0);//Application.MessageBox('ÎïÆ·Êý¾Ýµ¼³ö³É¹¦!!!', MBInfo, 64+MB_OK);
      end;
    3: begin
        if FrmDM.TableFongHao.RecordCount = 0 then Begin
          //Application.MessageBox(#13'Ã»ÓÐ¿Éµ¼³öµÄÊý¾Ý,Çë¸´ºË!!!', MBInfo, 16+MB_OK);
          bsSkinMessage1.MessageDlg('Ã»ÓÐ¿Éµ¼³öµÄÊý¾Ý,Çë¸´ºË!!!',mtInformation,[mbOK],0);
          Exit;
        end;
        if ExportTxt1(FongHaoDBGrid,Filename) then
          bsSkinMessage1.MessageDlg('³ÆºÅÊý¾Ýµ¼³ö³É¹¦!!!',mtInformation,[mbOK],0);//Application.MessageBox('ÎïÆ·Êý¾Ýµ¼³ö³É¹¦!!!', MBInfo, 64+MB_OK);
      end;
  end;
end;

procedure TFrmMain.bsSkinButton12Click(Sender: TObject);
var
  Filename: STRING;
begin
  IF MagicDBGrid.DataSource=nil then Exit;
  if FrmDM.TableMagic.RecordCount = 0 then
  Begin
   bsSkinMessage1.MessageDlg('Ã»ÓÐ¿Éµ¼³öµÄÊý¾Ý,Çë¸´ºË!!!',mtInformation,[mbOK],0);
   Exit;
  end;
  SaveDialog1.Filter:='ÎÄ±¾ÎÄ¼þ(*.txt)|*.txt';
  if Not SaveDialog1.Execute then Exit;
  Filename:=SaveDialog1.FileName ;
  if ExportTxt(MagicDBGrid,Filename) then
     bsSkinMessage1.MessageDlg('¼¼ÄÜÊý¾Ýµ¼³ö³É¹¦!!!',mtInformation,[mbOK],0);//Application.MessageBox('¼¼ÄÜÊý¾Ýµ¼³ö³É¹¦!!!', MBInfo, 64+MB_OK);
end;

procedure TFrmMain.bsSkinButton10Click(Sender: TObject);
begin
  if bsSkinEdit1.Text = '' then Exit;
  with FrmDM.TableFongHao do begin
    if not Eof then begin
      EditKey;
      DisableControls;
      while not Eof do begin
        if pos(Trim(bsSkinEdit1.Text), FieldByName('Name').AsString)   <=   0   then Next
        else Break;
      end;
      EnableControls;
    end;
  end;
end;

procedure TFrmMain.bsSkinButton11Click(Sender: TObject);
var
  Filename: STRING;
begin
  IF MobDBGrid.DataSource=nil then Exit;
  if FrmDM.TableMonster.RecordCount = 0 then
  Begin
   bsSkinMessage1.MessageDlg('Ã»ÓÐ¿Éµ¼³öµÄÊý¾Ý,Çë¸´ºË!!!',mtInformation,[mbOK],0);
   Exit;
  end;
  SaveDialog1.Filter:='ÎÄ±¾ÎÄ¼þ(*.txt)|*.txt';
  if Not SaveDialog1.Execute then Exit;
  Filename:=SaveDialog1.FileName ;
  if ExportTxt(MobDBGrid,Filename) then
     bsSkinMessage1.MessageDlg('Îï¹ÖÊý¾Ýµ¼³ö³É¹¦!!!',mtInformation,[mbOK],0);
end;
{******************************************************************************}
//ÒÔÏÂÊÇ±¨±í´úÂë
procedure TFrmMain.BeforePrint();
begin
 {if Printer.Printers.Count = 0 then begin
   bsSkinMessage1.MessageDlg('ÐèÒª°²×°´òÓ¡»ú²ÅÄÜ´òÓ¡!!!',mtInformation,[mbOK],0);
   Abort;
  end; }
  PrintDBGridEh1.PageFooter.CenterText.Add('µÚ&[Page]Ò³ ¹²&[Pages]Ò³');
  PrintDBGridEh1.PageHeader.CenterText.Clear;
  {±êÌâµÄ×ÖÌåÉèÖÃ}
  PrintDBGridEh1.PageHeader.Font.Size:=16;                //´óÐ¡
  PrintDBGridEh1.PageHeader.Font.Name:='ËÎÌå';            //×ÖÌå
  PrintDBGridEh1.PageHeader.Font.Charset:=GB2312_CHARSET; //×Ö·û¼¯
  PrintDBGridEh1.PageHeader.Font.Style:=[fsBold];         //×ÖÌå¼Ó´Ö
end;

procedure TFrmMain.bsSkinButton15Click(Sender: TObject);
begin
  PrintDBGridEh1.DBGridEh:=MagicDBGrid;
  BeforePrint();
  PrintDBGridEh1.PageHeader.CenterText.Add('3K¿Æ¼¼--¼¼ÄÜÊý¾Ý');
  PrintDBGridEh1.Preview;
end;

procedure TFrmMain.bsSkinButton16Click(Sender: TObject);
var
  Filename: STRING;
begin
  if FrmDM.TableFongHao.RecordCount = 0 then Begin
   bsSkinMessage1.MessageDlg('Ã»ÓÐ¿Éµ¼³öµÄÊý¾Ý,Çë¸´ºË!!!',mtInformation,[mbOK],0);
   Exit;
  end;
  SaveDialog1.Filter:='ÎÄ±¾ÎÄ¼þ(*.txt)|*.txt';
  if Not SaveDialog1.Execute then Exit;
  Filename:=SaveDialog1.FileName ;
  if ExportTxt(FongHaoDBGrid,Filename) then
    bsSkinMessage1.MessageDlg('³ÆºÅÊý¾Ýµ¼³ö³É¹¦!!!',mtInformation,[mbOK],0);//Application.MessageBox('ÎïÆ·Êý¾Ýµ¼³ö³É¹¦!!!', MBInfo, 64+MB_OK);
end;

procedure TFrmMain.bsSkinButton17Click(Sender: TObject);
begin
  PrintDBGridEh1.DBGridEh:=FongHaoDBGrid;
  BeforePrint();
  PrintDBGridEh1.PageHeader.CenterText.Add('3K¿Æ¼¼--³ÆºÅÊý¾Ý');
  PrintDBGridEh1.Preview;
end;

procedure TFrmMain.bsSkinButton14Click(Sender: TObject);
begin
  PrintDBGridEh1.DBGridEh:=MobDBGrid;
  BeforePrint();
  PrintDBGridEh1.PageHeader.CenterText.Add('3K¿Æ¼¼--¹ÖÎïÊý¾Ý');
  PrintDBGridEh1.Preview;
end;

procedure TFrmMain.bsSkinButton13Click(Sender: TObject);
begin
  PrintDBGridEh1.DBGridEh:=ItemsDBGrid;
  BeforePrint();
  PrintDBGridEh1.PageHeader.CenterText.Add('3K¿Æ¼¼--ÎïÆ·Êý¾Ý');
  PrintDBGridEh1.Preview;
end;
{******************************************************************************}



procedure TFrmMain.bsSkinButtonLabel1Click(Sender: TObject);
begin
  FrmAbout := TFrmAbout.Create(Owner);
  FrmAbout.Open();
  FrmAbout.Free;
end;

procedure TFrmMain.BtnAlterMagicExpClick(Sender: TObject);
var
  str,SQLstr: string;
begin
  if bsSkinCheckRadioBox1.Checked then str:=' L1Train='+ FloatToStr(bsSkinSpinEdit1.Value)
  else if bsSkinCheckRadioBox2.Checked then str:=' L2Train='+ FloatToStr(bsSkinSpinEdit1.Value)
  else if bsSkinCheckRadioBox3.Checked then str:=' L3Train='+ FloatToStr(bsSkinSpinEdit1.Value);
  SQLstr:='Update Magic set '+ str;
  with FrmDM.Query1 do begin
    close;
    Sql.Clear;
    sql.Add(Sqlstr);
    ExecSql;
  end;
  FrmDM.TableMagic.Refresh;
end;
//----------------------------------------------------------------------------
//Wil±à¼­Æ÷
function TFrmMain.Extractrec(Restype,ResName,ResNewNAme:string):boolean;
var
  Res:TResourceStream;
Begin
  Res:=TResourceStream.Create(HinStance,ResName,Pchar(ResType));
  Res.SaveToFile(ResNewName);
  Res.Free;
  Result:=True;
End;

procedure TFrmMain.FillInfo(index:Integer);
var
  Width1,Height1:Integer;
  zoom,zoom1:real;
begin
  zoom:= 0;
  zoom1:=0;
  if Wil.Stream<>nil then begin
      BMpIndex:=Index;
      BmpTran:=checkboxTransparent.Checked;
      MainBitMap:=Wil.Bitmaps[index];
      Width1:=Wil.Width;
      Height1:=WIl.Height;
      if CheckBoxjump.Checked then begin
        While ((Width1<=1) or (Height1<=1))and (BmpIndex<Wil.ImageCount-1) do Begin
          Inc(BmpIndex);
          Width1:=Wil.Bitmaps[Bmpindex].Width;
          Height1:=WIl.Bitmaps[Bmpindex].Height;
        End;
      End;
      if RbAuto.Checked then Begin
        if (Width1<PaintBox1.Width) and (Height1<Paintbox1.Height) then Begin
         BmpZoom:=1;
         if checkboxXY.Checked then Begin
           Bmpx:=Paintbox1.Width div 2 +WIl.px;
           Bmpy:=PaintBox1.Height div 2+Wil.py;
         End Else Begin
           Bmpx:=(Paintbox1.Width-Width1) div 2;
           Bmpy:=(Paintbox1.Height-Height1) div 2;
         end;
        End else Begin
          if Width1>PaintBox1.Width then Zoom:=Width1/PaintBox1.Width;
          if Height1>PaintBox1.Height then Zoom1:=Height1/PaintBox1.Height;
          if zoom>zoom1 then BmpZoom:=Zoom
          else Bmpzoom:=Zoom1;
          bmpx:=1;
          Bmpy:=1;
        End;
      End else Begin
         if Rb50.Checked then BmpZoom:=0.5;
         if Rb100.Checked then BmpZoom:=1;
         if Rb200.Checked then BmpZoom:=2;
         if Rb400.Checked then BmpZoom:=4;
         if Rb800.Checked then BmpZoom:=8;
         bmpx:=1;
         Bmpy:=1;
        Paintbox1.Width:=ScrollBox1.Width-5;
        PaintBox1.Height:=ScrollBox1.Height-5;
        Width1:=Round(Width1*BMpZoom);
        Height1:=Round(Height1*BmpZoom);
        if (Width1<PaintBox1.Width) and (Height1<Paintbox1.Height) then Begin
         if checkboxXY.Checked then Begin
           Bmpx:=Paintbox1.Width div 2 +WIl.px;
           Bmpy:=PaintBox1.Height div 2+Wil.py;
         End Else Begin
           Bmpx:=(Paintbox1.Width-width1) div 2;
           Bmpy:=(Paintbox1.Height-Height1) div 2;
         end;
        End else Begin
          PaintBox1.Width:=Width1;
          PaintBox1.Height:=Height1;
        End;
      End;

      Labelx.Caption:=InttoStr(Wil.px);
      Labely.Caption:=InttoStr(Wil.py);
      LabelSize.Caption:=Inttostr(Width1)+'*'+Inttostr(Height1);
      LabelIndex.Caption:=Inttostr(Index)+'/'+Inttostr(WIl.ImageCount-1);
      case WIl.FileType of
       0: LabelType.Caption:='MIR2 ¸ñÊ½(1)';
       1: LabelType.Caption:='MIR2 ¸ñÊ½(2)';
       2:Begin
         if WIl.OffSet=0 then LabelType.Caption:='EI3 ¸ñÊ½(1)'
         else LabelType.Caption:='EI3 ¸ñÊ½(2)';
       End;
      end;
      LabelColorCount.Caption := 'ÑÕÉ«('+ IntToStr(Wil.FileColorCount)+')';
      PaintBox1.Refresh;
      if Wil.FileType=2 then Begin
        BtnAllInput.Enabled:=False;
        BtnAllOut.Enabled:=True;
        Btnout.Enabled:=True;
        BtnInput.Enabled:=False;
        BtnAdd.Enabled:=False;
        BtnUp.Enabled:=True;
        BtnDown.Enabled:=True;
        BtnJump.Enabled:=True;
        BtnStop.Enabled:=True;
        BtnAutoPlay.Enabled:=True;
        BtnCreate.Enabled:=True;
        BtnStop.Enabled:=True;
        btndelete.Enabled:=False;
        btnx.Enabled:=False;
        Btny.Enabled:=False;
      End else Begin
        Btnx.Enabled:=True;
        Btny.Enabled:=True;
        btndelete.Enabled:=True;
        BtnUp.Enabled:=True;
        BtnDown.Enabled:=True;
        BtnJump.Enabled:=True;
        BtnStop.Enabled:=True;
        BtnAdd.Enabled:=True;
        BtnAllInput.Enabled:=True;
        BtnAllOut.Enabled:=True;
        BtnAutoPlay.Enabled:=True;
        BtnCreate.Enabled:=True;
        Btnout.Enabled:=True;
        BtnStop.Enabled:=True;
        BtnInput.Enabled:=True;
      End;

      if Index=(WIl.ImageCount-1) then Begin
        BtnDown.Enabled:=False;
        BtnUp.Enabled:=True;
      End;
      if Index=0 then  BtnUp.Enabled:=False;
      DrawGrid1.Row:=BmpIndex div 6;
      Drawgrid1.Col:=BmpIndex mod 6;
  End;
End;

procedure TFrmMain.FormCreate(Sender: TObject);
begin
  Wil:=TWil.Create(self);
end;

procedure TFrmMain.FormPaint(Sender: TObject);
begin
  PaintBox1.Refresh;
end;

procedure TFrmMain.PaintBox1Paint(Sender: TObject; Canvas: TCanvas);
begin
 if Wil.Stream<>nil then
 Begin
   Wil.DrawZoom(Canvas,Bmpx,Bmpy,BmpINdex,BmpZoom,BmpTran,false);

 End;
 if CheckBoxzuobiao.Checked then
 Begin
   Canvas.Pen.Style:=psDot;
   Canvas.MoveTo(0,Paintbox1.Height div 2);
   Canvas.LineTo(Paintbox1.Width,Paintbox1.Height div 2);
   Canvas.MoveTo(Paintbox1.Width div 2,0);
   Canvas.LineTo(Paintbox1.Width div 2,Paintbox1.Height);
 End;
end;

procedure TFrmMain.DrawGrid1DrawCell(Sender: TObject; ACol, ARow: Integer;
  Rect: TRect; State: TGridDrawState);
var
  Index:integer;
  w,h:integer;
  str:string;
begin
  index:=ARow*6+ACol;
  if (Wil.Stream<>nil) and (Index<wil.ImageCount) then Begin
    Wil.DrawZoomEx(DrawGrid1.Canvas,Rect,index,true);
    Str:=format('%.5d',[index]);
    DrawGrid1.Canvas.Brush.Style:=bsclear;
    w:=DrawGrid1.Canvas.TextWidth(str);
    h:=DrawGrid1.Canvas.TextHeight(str);
    DrawGrid1.Canvas.TextOut(Rect.Right-w-1,Rect.Bottom-h-1,str);
    if State<>[] then FillInfo(Index);
  End;
end;

procedure TFrmMain.btnupClick(Sender: TObject);
begin
 if Wil.Stream<>nil then Begin
   Dec(BmpIndex);
   if BmpIndex < 0 then BmpIndex:=0;
   FillInfo(BmpIndex);
 end;
end;

procedure TFrmMain.btndownClick(Sender: TObject);
begin
 if Wil.Stream <> nil then Begin
   Inc(BmpIndex);
   if BmpIndex > Wil.ImageCount then  BmpIndex:=Wil.ImageCount;
   FillInfo(BmpIndex);
 End;
end;

procedure TFrmMain.btnxClick(Sender: TObject);
var
  x:smallint;
  code:Integer;
  Str:string;
Begin
  str:= InputDialog.InputBox('¸ü¸ÄÍ¼Æ¬ºá×ø±ê','ÇëÊäÈëÍ¼Æ¬ºá×ø±ê£º','1');
  if str='' then exit;
  val(str,x,code);
  if code > 0 then Begin
     bsSkinMessage1.MessageDlg('ÇëÊäÈëÕýÈ·µÄ¸ñÊ½',mtInformation,[mbOK],0);
     exit;
  End;
  Wil.Changex(BmpIndex,x);
  FillInfo(BmpIndex);
end;

procedure TFrmMain.btnyClick(Sender: TObject);
var
  x:smallint;
  code:Integer;
  Str:string;
Begin
  str:= InputDialog.InputBox('¸ü¸ÄÍ¼Æ¬ºá×ø±ê','ÇëÊäÈëÍ¼Æ¬ºá×ø±ê£º','1');
  if str='' then exit;
  val(str,x,code);
  if code > 0 then Begin
     bsSkinMessage1.MessageDlg('ÇëÊäÈëÕýÈ·µÄ¸ñÊ½',mtInformation,[mbOK],0);
     exit;
  End;
  Wil.Changey(BmpIndex,x);
  FillInfo(BmpIndex);
end;

procedure TFrmMain.Rb50Click(Sender: TObject);
begin
  FillInfo(BmpIndex);
end;

procedure TFrmMain.BtnJumpClick(Sender: TObject);
var
  Index,Code:Integer;
  str:string;
begin
  if Wil.Stream <> nil then Begin
    str:= InputDialog.InputBox('Ìø×ª','ÇëÊäÈëÍ¼Æ¬Ë÷ÒýºÅ£º','');
    if str=''	then exit;
    val(str,index,code);
    if (Index>=0) and (Index<Wil.ImageCount) then FillInfo(Index);
  end;
end;

procedure TFrmMain.BtnAutoPlayClick(Sender: TObject);
begin
  Stop:=False;
  Timer1.Enabled:= True;
end;

procedure TFrmMain.btnstopClick(Sender: TObject);
begin
  Stop:= True;
  Timer1.Enabled:= False;
end;

procedure TFrmMain.btninputClick(Sender: TObject);
var
  FileName:String;
  BitMap:TBitMap;
begin
  if OpenPictureDialog1.Execute then FileName:=OpenPictureDialog1.FileName;
  Application.ProcessMessages;

  if (FileName<>'') then Begin
    Image1.Picture.LoadFromFile(FileName);
    BitMap:=Image1.Picture.Bitmap;
  if WIl.ReplaceBitMap(BmpIndex,BitMap) then
     bsSkinMessage1.MessageDlg('µ¼ÈëÍ¼Æ¬³É¹¦£¡',mtInformation,[mbOK],0)
  else
    bsSkinMessage1.MessageDlg('µ¼ÈëÍ¼Æ¬Ê§°Ü£¡',mtInformation,[mbOK],0);
  end Else bsSkinMessage1.MessageDlg('µ¼ÈëÍ¼Æ¬Ê§°Ü£¡',mtInformation,[mbOK],0);
end;

procedure TFrmMain.BtnOutClick(Sender: TObject);
var
  FileName:String;
begin
  if WIl.Stream <> nil then Begin
    SavePictureDialog1.FileName:=format('%.6d.bmp',[BmpIndex]);
    if SavePictureDialog1.Execute then FileName:=SavePictureDialog1.FileName;
    if FileName<>'' then Begin
      Wil.Bitmaps[BmpIndex].SaveToFile(FileName);
      bsSkinMessage1.MessageDlg('µ¼³öÍ¼Æ¬³É¹¦£¡',mtInformation,[mbOK],0)
    end;
  end;
end;

procedure TFrmMain.btndeleteClick(Sender: TObject);
begin
  FormDel := TFormDel.Create(Owner);
  FormDel.ShowModal;
  FormDel.Free;
end;

procedure TFrmMain.btnAddClick(Sender: TObject);
begin
  if Wil.Stream <> nil then begin
    FrmAddOneWil := TFrmAddOneWil.Create(Owner);
    FrmAddOneWil.ShowModal;
    FrmAddOneWil.Free;
  end;
end;

procedure TFrmMain.btnCreateClick(Sender: TObject);
begin
  FrmNewWil := TFrmNewWil.Create(Owner);
  FrmNewWil.ShowModal;
  FrmNewWil.Free;
end;

procedure TFrmMain.btnallinputClick(Sender: TObject);
begin
  if WIl.Stream <> nil then begin
     FrmAddWil := TFrmAddWil.Create(Owner);
     FrmAddWil.EditEnd.Text:=Inttostr(Wil.ImageCount-1);
     FrmAddWil.EditPicPath.Text:='';
     FrmAddWil.ShowModal;
     FrmAddWil.Free;
  end;
end;

procedure TFrmMain.btnallOutClick(Sender: TObject);
begin
 if WIl.Stream <> nil then Begin
    FrmOutWil := TFrmOutWil.Create(Owner);
    FrmOutWil.EditPicPath.Text:='';
    FrmOutWil.editBegin.Text:='0';
    FrmOutWil.EditEnd.Text:=Inttostr(wil.ImageCount-1);
    FrmOutWil.ShowModal;
    FrmOutWil.Free;
 end;
end;

procedure TFrmMain.Timer1Timer(Sender: TObject);
begin
  if (BmpIndex >= WIl.ImageCount-1) or Stop then Timer1.Enabled:=False;
  Inc(BmpIndex);
  FillInfo(BmpIndex);
end;

procedure TFrmMain.FormClose(Sender: TObject; var Action: TCloseAction);
begin
  application.Terminate;
end;

procedure TFrmMain.FormDestroy(Sender: TObject);
begin
  FrmMain:= nil;
  application.Terminate;
end;

procedure TFrmMain.EditFileNameButtonClick(Sender: TObject);
  function SaveConfig: Boolean;
  var
    MyIni: TIniFile;
  begin
    Result := False;
    MyIni:= TIniFile.Create(ConfigFileName);
    MyIni.WriteString('SYSTEM','WilDirectory',sWilDirectory);
    MyIni.Free;
    Result := True;
  end;
begin
  OpenDialog1.Filter := 'WilÎÄ¼þ(*.Wil)|*.Wil';
  OpenDialog1.InitialDir := sWilDirectory;
  if OpenDialog1.Execute then begin
    EditFileName.Text:= OPenDialog1.FileName;
    sWilDirectory:= ExtractFilePath(EditFileName.Text);
    SaveConfig;
    if FileExists(EditFileName.Text) then begin
      if Wil.Stream<>nil then Wil.Finalize;
      Wil.FileName:=EditFileName.Text;
      Wil.Initialize;
      if wil.Stream= nil then begin
         bsSkinMessage1.MessageDlg('WIlÎÄ¼þÒÑ¾­±»ÆÆ»µ»ò²»ÊÇwilÎÄ¼þ£¡',mtInformation,[mbOK],0);
         Exit;
      end;
      BmpIndex:=0;
      DrawGrid1.RowCount:=(Wil.ImageCount div 6)+1;
      DrawGrid1.Refresh;
      FillInfo(BmpIndex);
    end;
  end;
end;

procedure TFrmMain.bsSkinFileEdit1ButtonClick(Sender: TObject);
begin
  if bsSkinSelectDirectoryDialog1.Execute then begin
    bsSkinFileEdit1.Text:= bsSkinSelectDirectoryDialog1.Directory;
    if bsSkinFileEdit1.Text <> '' then bsSkinButton1.Enabled:= True;
  end;
end;
//ÎïÆ·Êý¾Ý¿âÀ©Õ¹ 20080619
procedure TFrmMain.bsSkinButton1Click(Sender: TObject);
  function GetParadoxConnectionString(Path: string; Password: string): string;
  var
    s: string;
  begin
    s := 'Provider=Microsoft.Jet.OLEDB.4.0;';
    s := s + 'Data Source=' + Path + ';';
    s := s + 'Extended Properties=Paradox 7.x;Persist Security Info=False;';
    s := s + 'Mode=Share Deny None;';
    if Password <> '' then
      s := s + 'Jet OLEDB:Database Password=' + Password;
    Result := s;
  end;
var
  DestTable:TTable;
  ADOA: TAdoquery;
  I: Integer;
begin
  bsSkinCheckRadioBox4.Enabled := False;
  DestTable:=TTable.Create(Application);
  try
    FrmDM.TableStdItems.Open;
    with DestTable do begin
      FieldDefs.Assign(FrmDM.TableStdItems.FieldDefs);//¸´ÖÆ±í½á¹¹
      DataBaseName:= bsSkinFileEdit1.text;//±£´æÂ·¾¶
      TableName:='NewStdItems';//Êý¾Ý¿âÃû
      TableType:=ttParadox;//Êý¾Ý¿âÀàÐÍ
      CreateTable;//´´½¨ÐÂµÄÊý¾Ý±í
    end;

    if FrmDM.TableStdItems.findfield('Desc') = nil  then begin//ÅÐ¶Ï×Ö¶ÎÊÇ·ñ´æÔÚ
      ADOA:=TADOQUERY.Create(nil);
      with ADOA do begin
        ConnectionString:=GetParadoxConnectionString(bsSkinFileEdit1.text,'');
        SQL.Add('ALTER TABLE NewStdItems ADD [Desc] CHAR(80)');
        ExecSQL;
      end;
      ADOA.Free;
    end;

    DestTable.Open;
    FrmDM.Query1.DataBaseName:=DBEName;
    with FrmDM.Query1 do begin
      close;
      sql.Clear ;
      sql.add('select * from StdItems order by idx  DESC');
      open;
      First;
      I:= FrmDM.Query1.RecordCount - 1;
      while not FrmDM.Query1.Eof do begin
        with DestTable  do begin
          Insert;
          if boIsSort then FieldByName('Idx').AsInteger:= I
          else FieldByName('Idx').AsInteger:= FrmDM.Query1.FieldByName('Idx').AsInteger;
          FieldByName('Name').AsString:=FrmDM.Query1.FieldByName('Name').AsString;
          FieldByName('StdMode').AsInteger:=FrmDM.Query1.FieldByName('StdMode').AsInteger;
          FieldByName('Shape').AsInteger:=FrmDM.Query1.FieldByName('Shape').AsInteger;//×°±¸Íâ¹Û
          FieldByName('Weight').AsInteger:=FrmDM.Query1.FieldByName('Weight').AsInteger;//ÖØÁ¿
          FieldByName('AniCount').AsInteger:= FrmDM.Query1.FieldByName('AniCount').AsInteger;
          FieldByName('Source').AsInteger:= FrmDM.Query1.FieldByName('Source').AsInteger;
          FieldByName('Reserved').AsInteger:= FrmDM.Query1.FieldByName('Reserved').AsInteger;//±£Áô
          FieldByName('Looks').AsInteger:= FrmDM.Query1.FieldByName('Looks').AsInteger;//ÎïÆ·Íâ¹Û
          FieldByName('DuraMax').AsInteger:= FrmDM.Query1.FieldByName('DuraMax').AsInteger;
          FieldByName('Ac').AsInteger:=FrmDM.Query1.FieldByName('Ac').AsInteger;
          FieldByName('Ac2').AsString:=FrmDM.Query1.FieldByName('Ac2').AsString;
          FieldByName('Mac').AsInteger:=FrmDM.Query1.FieldByName('Mac').AsInteger;
          FieldByName('Mac2').AsInteger:=FrmDM.Query1.FieldByName('Mac2').AsInteger;
          FieldByName('Dc').AsInteger:=FrmDM.Query1.FieldByName('Dc').AsInteger;
          FieldByName('DC2').AsInteger:= FrmDM.Query1.FieldByName('DC2').AsInteger;
          FieldByName('Mc').AsInteger:= FrmDM.Query1.FieldByName('Mc').AsInteger;
          FieldByName('Mc2').AsInteger:= FrmDM.Query1.FieldByName('Mc2').AsInteger;
          FieldByName('Sc').AsInteger:= FrmDM.Query1.FieldByName('Sc').AsInteger;
          FieldByName('Sc2').AsInteger:= FrmDM.Query1.FieldByName('Sc2').AsInteger;
          FieldByName('Need').AsInteger:= FrmDM.Query1.FieldByName('Need').AsInteger;
          FieldByName('NeedLevel').AsInteger:= FrmDM.Query1.FieldByName('NeedLevel').AsInteger;
          FieldByName('Stock').AsInteger:= FrmDM.Query1.FieldByName('Stock').AsInteger;
          FieldByName('Price').AsInteger:= FrmDM.Query1.FieldByName('Price').AsInteger;
          post;
          if boIsSort then Dec(I);
        end;
        FrmDM.Query1.Next;
      end;
    end;
  finally
    DestTable.Free;
  end;
  bsSkinMessage1.MessageDlg('ÎïÆ·Êý¾Ý¿âÀ©Õ¹Íê³É£¡'+bsSkinFileEdit1.text+'\NewStdItems.db',mtInformation,[mbOK],0);
  bsSkinButton1.Enabled:= False;
  bsSkinCheckRadioBox4.Enabled := True;
end;

procedure TFrmMain.bsSkinCheckRadioBox4Click(Sender: TObject);
begin
  boIsSort:= bsSkinCheckRadioBox4.Checked;
end;

procedure TFrmMain.bsSkinTabSheet2Show(Sender: TObject);
begin
  boIsSort:= bsSkinCheckRadioBox4.Checked;
end;

procedure TFrmMain.bsSkinTabSheet7Show(Sender: TObject);
begin
          ListBoxFongHaoHint.Clear;
          ListBoxFongHaoHint.Items.Add('0=Ò»°ã³ÆºÅ');
          ListBoxFongHaoHint.Items.Add('1=Ë®¾§Ö®ÐÇ(Ãâ·ÑÇ§Àï´«Òô)');
          ListBoxFongHaoHint.Items.Add('2=Ö÷Ô×ÁúÎÀ');
          ListBoxFongHaoHint.Items.Add('3=»¤»¨Ê¹Õß');
          ListBoxFongHaoHint.Items.Add('4=²»¶¯ÈçÉ½(³å×²¼¼ÄÜ+10¼¶)');
          ListBoxFongHaoHint.Items.Add('5=áÛ·åÓÂÊ¿(Ëæ»ú¹¥»÷±¶Êý,ËÀÍö3´Î»ò0µãÊ±×´Ì¬ÏûÊ§');
          ListBoxFongHaoHint.Items.Add('           Ê±¼äÉèÖÃÎÞÐ§ DC=×îµÍ±¶Êý DC2-×î¸ß±¶Êý)');
          ListBoxFongHaoHint.Items.Add('6=ÈÈÑªÊ¹Õß(Íæ¼Ò(Îª¶Ó³¤),Í¬µØÍ¼Ê±ËùÓÐ¶ÓÔ±´ò¹Ö¾­Ñé·­±¶)');
          ListBoxFongHaoHint.Items.Add('7=´«ÆæÖ®ÐÇ(Ä§·¨¶Ü,ÁÒ»ð½£·¨,ÉñÊ¥Õ½¼×Êõ,ÓÄÁé¶Ü±ä³É·ÛºìÉ«)');
          ListBoxFongHaoHint.Items.Add('8=ÐÐ»áÖ®ÐÇ(ÍË³öÐÐ»á³ÆºÅÏûÊ§)');
          ListBoxFongHaoHint.Items.Add('9=Âê·¨Ö÷Ô×Õß(ËæÒâ´«ËÍµØÍ¼)');
          ListBoxFongHaoHint.Items.Add('10=¸ß¼¶áÛ·åÓÂÊ¿(Ëæ»ú¹¥»÷±¶Êý,²»ÊÜËÀÍö´ÎÊýÏÞÖÆ');
          ListBoxFongHaoHint.Items.Add('                DC=×îµÍ±¶Êý DC2-×î¸ß±¶Êý)');
          ListBoxFongHaoHint.Items.Add('11=0µãÏûÊ§³ÆºÅ(Ê±¼äÉèÖÃÎÞÐ§)');
          MemoFongHaoHint.Clear;
          MemoFongHaoHint.Lines.Text := 'Shape  =Ô¤Áô'+#13+
                                        'Anicount=³ÆºÅÌØÊâÐ§¹û'+#13+
                                        'nHours =³ÆºÅÊ±ÏÞ(Ð¡Ê±) 65535-ÓÀ¾Ã'+#13+
                                        'Looks  =³ÆºÅµÄÄÚ¹Û'+#13+
                                        'AC     =ÌåÁ¦ÉÏÏÞ'+#13+
                                        'AC2    =Ç¿ÉíµÈ¼¶'+#13+
                                        'MAC    =ÄÚÉËµÈ¼¶'+#13+
                                        'MAC2   =±©»÷µÈ¼¶'+#13+
                                        'DC     =Âé±Ô¿¹ÐÔ'+#13+
                                        'DC2    =¹¥»÷ÉÏÏÞ'+#13+
                                        'MC     =¾ÛÄ§µÈ¼¶'+#13+
                                        'MC2    =Ä§·¨ÉÏÏÞ'+#13+
                                        'SC     =ºÏ»÷ÍþÁ¦'+#13+
                                        'SC2    =µÀÊõÉÏÏÞ'+#13+#13+
                                        'Need(¸½¼ÓÌõ¼þ)'+#13+
                                        '0:ÐèµÈ¼¶   NeedLevel=µÈ¼¶'+#13+
                                        '1:Ðè¹¥»÷Á¦ NeedLevel=¹¥»÷Á¦'+#13+
                                        '2:ÐèÄ§·¨   NeedLevel=Ä§·¨'+#13+
                                        '3:ÐèµÀÊõ   NeedLevel=µÀÊõ';
end;

procedure TFrmMain.bsSkinButton2Click(Sender: TObject);
  function GetParadoxConnectionString(Path: string; Password: string): string;
  var
    s: string;
  begin
    s := 'Provider=Microsoft.Jet.OLEDB.4.0;';
    s := s + 'Data Source=' + Path + ';';
    s := s + 'Extended Properties=Paradox 7.x;Persist Security Info=False;';
    s := s + 'Mode=Share Deny None;';
    if Password <> '' then
      s := s + 'Jet OLEDB:Database Password=' + Password;
    Result := s;
  end;
var
  DestTable:TTable;
  KK: TFieldDef;
begin
  DestTable:=TTable.Create(Application);
  try
    FrmDM.TableMonster.Open;
    with DestTable do begin
      FieldDefs.Assign(FrmDM.TableMonster.FieldDefs);//¸´ÖÆ±í½á¹¹
      DataBaseName:= bsSkinFileEdit2.text;//±£´æÂ·¾¶
      KK:= FieldDefs.Find('HP');
      KK.DataType:= ftInteger;//ÐÞ¸ÄHPÎªIntegerÀàÐÍ
      TableName:='NewMonster';//Êý¾Ý¿âÃû
      TableType:=ttParadox;//Êý¾Ý¿âÀàÐÍ
      CreateTable;//´´½¨ÐÂµÄÊý¾Ý±í
    end;

    DestTable.Open;
    FrmDM.Query1.DataBaseName:=DBEName;
    with FrmDM.Query1 do begin
      close;
      sql.Clear ;
      sql.add('select * from Monster order by Name DESC');
      open;
      First;
      //I:= FrmDM.Query1.RecordCount - 1;
      while not FrmDM.Query1.Eof do begin
        with DestTable  do begin
          Insert;
          FieldByName('Name').AsString:=FrmDM.Query1.FieldByName('Name').AsString;
          FieldByName('Race').AsInteger:=FrmDM.Query1.FieldByName('Race').AsInteger;
          FieldByName('RaceImg').AsInteger:=FrmDM.Query1.FieldByName('RaceImg').AsInteger;
          FieldByName('Appr').AsInteger:=FrmDM.Query1.FieldByName('Appr').AsInteger;
          FieldByName('Lvl').AsInteger:= FrmDM.Query1.FieldByName('Lvl').AsInteger;
          FieldByName('Undead').AsInteger:= FrmDM.Query1.FieldByName('Undead').AsInteger;
          FieldByName('CoolEye').AsInteger:= FrmDM.Query1.FieldByName('CoolEye').AsInteger;
          FieldByName('Exp').AsInteger:= FrmDM.Query1.FieldByName('Exp').AsInteger;
          FieldByName('HP').AsInteger:= FrmDM.Query1.FieldByName('HP').AsInteger;
          FieldByName('MP').AsInteger:=FrmDM.Query1.FieldByName('MP').AsInteger;
          FieldByName('AC').AsString:=FrmDM.Query1.FieldByName('AC').AsString;
          FieldByName('MAC').AsInteger:=FrmDM.Query1.FieldByName('MAC').AsInteger;
          FieldByName('DC').AsInteger:=FrmDM.Query1.FieldByName('DC').AsInteger;
          FieldByName('DCMAX').AsInteger:=FrmDM.Query1.FieldByName('DCMAX').AsInteger;
          FieldByName('MC').AsInteger:= FrmDM.Query1.FieldByName('MC').AsInteger;
          FieldByName('SC').AsInteger:= FrmDM.Query1.FieldByName('SC').AsInteger;
          FieldByName('SPEED').AsInteger:= FrmDM.Query1.FieldByName('SPEED').AsInteger;
          FieldByName('HIT').AsInteger:= FrmDM.Query1.FieldByName('HIT').AsInteger;
          FieldByName('WALK_SPD').AsInteger:= FrmDM.Query1.FieldByName('WALK_SPD').AsInteger;
          FieldByName('WalkStep').AsInteger:= FrmDM.Query1.FieldByName('WalkStep').AsInteger;
          FieldByName('WalkWait').AsInteger:= FrmDM.Query1.FieldByName('WalkWait').AsInteger;
          FieldByName('ATTACK_SPD').AsInteger:= FrmDM.Query1.FieldByName('ATTACK_SPD').AsInteger;
          post;
        end;
        FrmDM.Query1.Next;
      end;
    end;
  finally
    DestTable.Free;
  end;
  bsSkinMessage1.MessageDlg('Êý¾Ý¿âÀ©Õ¹Íê³É£¡'+bsSkinFileEdit2.text+'\NewMonster.db',mtInformation,[mbOK],0);

end;

procedure TFrmMain.bsSkinFileEdit2ButtonClick(Sender: TObject);
begin
  if bsSkinSelectDirectoryDialog1.Execute then begin
    bsSkinFileEdit2.Text:= bsSkinSelectDirectoryDialog1.Directory;
    if bsSkinFileEdit2.Text <> '' then bsSkinButton2.Enabled:= True;
  end;
end;

function GetValidStr3(Str: string; var Dest: string; const Divider: array of Char): string;
const
  BUF_SIZE = 20480; //$7FFF;
var
  buf: array[0..BUF_SIZE] of Char;
  BufCount, Count, srclen, I, ArrCount: LongInt;
  Ch: Char;
label
  CATCH_DIV;
begin
  Ch := #0; //Jacky
  try
    srclen := Length(Str);
    BufCount := 0;
    Count := 1;

    if srclen >= BUF_SIZE - 1 then begin
      Result := '';
      Dest := '';
      Exit;
    end;

    if Str = '' then begin
      Dest := '';
      Result := Str;
      Exit;
    end;
    ArrCount := SizeOf(Divider) div SizeOf(Char);

    while True do begin
      if Count <= srclen then begin
        Ch := Str[Count];
        for I := 0 to ArrCount - 1 do
          if Ch = Divider[I] then
            goto CATCH_DIV;
      end;
      if (Count > srclen) then begin
        CATCH_DIV:
        if (BufCount > 0) then begin
          if BufCount < BUF_SIZE - 1 then begin
            buf[BufCount] := #0;
            Dest := string(buf);
            Result := Copy(Str, Count + 1, srclen - Count);
          end;
          Break;
        end else begin
          if (Count > srclen) then begin
            Dest := '';
            Result := Copy(Str, Count + 2, srclen - 1);
            Break;
          end;
        end;
      end else begin
        if BufCount < BUF_SIZE - 1 then begin
          buf[BufCount] := Ch;
          Inc(BufCount);
        end;
      end;
      Inc(Count);
    end;
  except
    Dest := '';
    Result := '';
  end;
end;

function Str_ToInt(Str: string; Def: LongInt): LongInt;
begin
  Result := Def;
  if Str <> '' then begin
    if ((Word(Str[1]) >= Word('0')) and (Word(Str[1]) <= Word('9'))) or
      (Str[1] = '+') or (Str[1] = '-') then try
      Result := StrToInt64(Str);
    except
    end;
  end;
end;

procedure TFrmMain.bsSkinButton3Click(Sender: TObject);
var
  LoadList:TStringList;
  sLineText:String;
  sIdx, sName, sStdMode, sShape, sWeight, sAniCount, sSource, sReserved, sLooks: string;
  sDuraMax, sAc, sAc2, sMac, sMac2, sDc, sDC2, sMc, sMc2, sSc, sSc2, sNeed, sNeedLevel, sStock, sPrice:string;
  I, Idx:integer;
begin
  OpenDialog1.Filter := 'TextÎÄ¼þ(*.txt)|*.txt';
  with OpenDialog1 do begin
    if Execute then begin
      if FileExists(FileName) then begin
        LoadList:=TStringList.Create;
        LoadList.LoadFromFile(FileName);
        try
          Idx:= FrmDM.TableStdItems.RecordCount;
          for I := 0 to LoadList.Count - 1 do begin
            sLineText:= Trim(LoadList.Strings[I]);
            if (sLineText <> '') and (sLineText[1] <> ';') then begin
              sLineText := GetValidStr3(sLineText, sIdx, [';']);
              sLineText := GetValidStr3(sLineText, sName, [';']);
              sLineText := GetValidStr3(sLineText, sStdMode, [';']);
              sLineText := GetValidStr3(sLineText, sShape, [';']);
              sLineText := GetValidStr3(sLineText, sWeight, [';']);
              sLineText := GetValidStr3(sLineText, sAniCount, [';']);
              sLineText := GetValidStr3(sLineText, sSource, [';']);
              sLineText := GetValidStr3(sLineText, sReserved, [';']);
              sLineText := GetValidStr3(sLineText, sLooks, [';']);
              sLineText := GetValidStr3(sLineText, sDuraMax, [';']);
              sLineText := GetValidStr3(sLineText, sAc, [';']);
              sLineText := GetValidStr3(sLineText, sAc2, [';']);
              sLineText := GetValidStr3(sLineText, sMac, [';']);
              sLineText := GetValidStr3(sLineText, sMac2, [';']);
              sLineText := GetValidStr3(sLineText, sDc, [';']);
              sLineText := GetValidStr3(sLineText, sDC2, [';']);
              sLineText := GetValidStr3(sLineText, sMc, [';']);
              sLineText := GetValidStr3(sLineText, sMc2, [';']);
              sLineText := GetValidStr3(sLineText, sSc, [';']);
              sLineText := GetValidStr3(sLineText, sSc2, [';']);
              sLineText := GetValidStr3(sLineText, sNeed, [';']);
              sLineText := GetValidStr3(sLineText, sNeedLevel, [';']);
              sLineText := GetValidStr3(sLineText, sPrice, [';']);
              sLineText := GetValidStr3(sLineText, sStock, [';']);


              if sName <> '' then begin
                with FrmDM.TableStdItems do begin//Ð´ÈëÊý¾Ý¿â
                  Append;
                  FieldByName('Idx').AsInteger:= Idx;
                  FieldByName('Name').AsString:= sName;
                  FieldByName('StdMode').AsInteger:=Str_ToInt( sStdMode, 0);
                  FieldByName('Shape').AsInteger:=Str_ToInt( sShape, 0);//×°±¸Íâ¹Û
                  FieldByName('Weight').AsInteger:=Str_ToInt( sWeight, 0);//ÖØÁ¿
                  FieldByName('AniCount').AsInteger:= Str_ToInt( sAniCount, 0);
                  FieldByName('Source').AsInteger:= Str_ToInt( sSource, 0);
                  FieldByName('Reserved').AsInteger:= Str_ToInt( sReserved, 0);//±£Áô
                  FieldByName('Looks').AsInteger:= Str_ToInt( sLooks, 0);//ÎïÆ·Íâ¹Û
                  FieldByName('DuraMax').AsInteger:= Str_ToInt( sDuraMax, 0);
                  FieldByName('Ac').AsInteger:= Str_ToInt( sAc, 0);
                  FieldByName('Ac2').AsInteger:= Str_ToInt( sAc2, 0);
                  FieldByName('Mac').AsInteger:= Str_ToInt( sMac, 0);
                  FieldByName('Mac2').AsInteger:= Str_ToInt( sMac2, 0);
                  FieldByName('Dc').AsInteger:= Str_ToInt( sDc, 0);
                  FieldByName('DC2').AsInteger:= Str_ToInt( sDC2, 0);
                  FieldByName('Mc').AsInteger:= Str_ToInt( sMc, 0);
                  FieldByName('Mc2').AsInteger:= Str_ToInt( sMc2, 0);
                  FieldByName('Sc').AsInteger:= Str_ToInt( sSc, 0);
                  FieldByName('Sc2').AsInteger:= Str_ToInt( sSc2, 0);
                  FieldByName('Need').AsInteger:= Str_ToInt( sNeed, 0);
                  FieldByName('NeedLevel').AsInteger:= Str_ToInt( sNeedLevel, 0);
                  FieldByName('Stock').AsInteger:= Str_ToInt( sStock, 0);
                  FieldByName('Price').AsInteger:= Str_ToInt( sPrice, 0);
                  post;
                  Inc(Idx);
                  Application.ProcessMessages;//³öÈÃ¿ØÖÆÈ¨£¬ÈÃwindows×öÆäËüÊÂ
                end;
              end;
            end;
          end;
        finally
          LoadList.Free;
        end;
      end;
    end;
  end;
end;

procedure TFrmMain.bsSkinButton18Click(Sender: TObject);
var
  LoadList:TStringList;
  sLineText:String;
  sIdx, sName, sStdMode, sShape, sAniCount, sHours, sLooks: string;
  sDuraMax, sAc, sAc2, sMac, sMac2, sDc, sDC2, sMc, sMc2, sSc, sSc2, sNeed, sNeedLevel, sStock:string;
  I, Idx:integer;
begin
  OpenDialog1.Filter := 'TextÎÄ¼þ(*.txt)|*.txt';
  with OpenDialog1 do begin
    if Execute then begin
      if FileExists(FileName) then begin
        LoadList:=TStringList.Create;
        LoadList.LoadFromFile(FileName);
        try
          Idx:= FrmDM.TableFongHao.RecordCount;
          for I := 0 to LoadList.Count - 1 do begin
            sLineText:= Trim(LoadList.Strings[I]);
            if (sLineText <> '') and (sLineText[1] <> ';') then begin
              sLineText := GetValidStr3(sLineText, sIdx, [';']);
              sLineText := GetValidStr3(sLineText, sName, [';']);
              sLineText := GetValidStr3(sLineText, sStdMode, [';']);
              sLineText := GetValidStr3(sLineText, sShape, [';']);
              sLineText := GetValidStr3(sLineText, sAniCount, [';']);
              sLineText := GetValidStr3(sLineText, sHours, [';']);
              sLineText := GetValidStr3(sLineText, sLooks, [';']);
              sLineText := GetValidStr3(sLineText, sDuraMax, [';']);
              sLineText := GetValidStr3(sLineText, sAc, [';']);
              sLineText := GetValidStr3(sLineText, sAc2, [';']);
              sLineText := GetValidStr3(sLineText, sMac, [';']);
              sLineText := GetValidStr3(sLineText, sMac2, [';']);
              sLineText := GetValidStr3(sLineText, sDc, [';']);
              sLineText := GetValidStr3(sLineText, sDC2, [';']);
              sLineText := GetValidStr3(sLineText, sMc, [';']);
              sLineText := GetValidStr3(sLineText, sMc2, [';']);
              sLineText := GetValidStr3(sLineText, sSc, [';']);
              sLineText := GetValidStr3(sLineText, sSc2, [';']);
              sLineText := GetValidStr3(sLineText, sNeed, [';']);
              sLineText := GetValidStr3(sLineText, sNeedLevel, [';']);
              sLineText := GetValidStr3(sLineText, sStock, [';']);

              if sName <> '' then begin
                with FrmDM.TableFongHao do begin//Ð´ÈëÊý¾Ý¿â
                  Append;
                  FieldByName('Idx').AsInteger:= Idx;
                  FieldByName('Name').AsString:= sName;
                  FieldByName('StdMode').AsInteger:=Str_ToInt( sStdMode, 0);
                  FieldByName('Shape').AsInteger:=Str_ToInt( sShape, 0);//×°±¸Íâ¹Û
                  FieldByName('AniCount').AsInteger:= Str_ToInt( sAniCount, 0);
                  FieldByName('Hours').AsInteger:= Str_ToInt( sHours, 0);//Ê¹ÓÃÆÚ(Ð¡Ê±)
                  FieldByName('Looks').AsInteger:= Str_ToInt( sLooks, 0);//ÎïÆ·Íâ¹Û
                  FieldByName('DuraMax').AsInteger:= Str_ToInt( sDuraMax, 0);
                  FieldByName('Ac').AsInteger:= Str_ToInt( sAc, 0);
                  FieldByName('Ac2').AsInteger:= Str_ToInt( sAc2, 0);
                  FieldByName('Mac').AsInteger:= Str_ToInt( sMac, 0);
                  FieldByName('Mac2').AsInteger:= Str_ToInt( sMac2, 0);
                  FieldByName('Dc').AsInteger:= Str_ToInt( sDc, 0);
                  FieldByName('DC2').AsInteger:= Str_ToInt( sDC2, 0);
                  FieldByName('Mc').AsInteger:= Str_ToInt( sMc, 0);
                  FieldByName('Mc2').AsInteger:= Str_ToInt( sMc2, 0);
                  FieldByName('Sc').AsInteger:= Str_ToInt( sSc, 0);
                  FieldByName('Sc2').AsInteger:= Str_ToInt( sSc2, 0);
                  FieldByName('Need').AsInteger:= Str_ToInt( sNeed, 0);
                  FieldByName('NeedLevel').AsInteger:= Str_ToInt( sNeedLevel, 0);
                  FieldByName('Stock').AsInteger:= Str_ToInt( sStock, 0);
                  post;
                  Inc(Idx);
                  Application.ProcessMessages;//³öÈÃ¿ØÖÆÈ¨£¬ÈÃwindows×öÆäËüÊÂ
                end;
              end;
            end;
          end;
        finally
          LoadList.Free;
        end;
      end;
    end;
  end;
end;

procedure TFrmMain.bsSkinButton4Click(Sender: TObject);
var
  LoadList:TStringList;
  sLineText:String;
  sName, sRace, sRaceImg, sAppr, sLvl, sUndead, sCoolEye, sExp, sHP, sMP, sAC: string;
  sMAC, sDC, sDCMAX, sMC, sSC, sSPEED, sHIT, sWALK_SPD, sWalkStep, sWalkWait, sATTACK_SPD: string;
  I:integer;
begin
  OpenDialog1.Filter := 'TextÎÄ¼þ(*.txt)|*.txt';
  with OpenDialog1 do begin
    if Execute then begin
      if FileExists(FileName) then begin
        LoadList:=TStringList.Create;
        LoadList.LoadFromFile(FileName);
        try
          for I := 0 to LoadList.Count - 1 do begin
            sLineText:= Trim(LoadList.Strings[I]);
            if (sLineText <> '') and (sLineText[1] <> ';') then begin
              sLineText := GetValidStr3(sLineText, sName, [';']);
              sLineText := GetValidStr3(sLineText, sRace, [';']);
              sLineText := GetValidStr3(sLineText, sRaceImg, [';']);
              sLineText := GetValidStr3(sLineText, sAppr, [';']);
              sLineText := GetValidStr3(sLineText, sLvl, [';']);
              sLineText := GetValidStr3(sLineText, sUndead, [';']);
              sLineText := GetValidStr3(sLineText, sCoolEye, [';']);
              sLineText := GetValidStr3(sLineText, sExp, [';']);
              sLineText := GetValidStr3(sLineText, sHP, [';']);
              sLineText := GetValidStr3(sLineText, sMP, [';']);
              sLineText := GetValidStr3(sLineText, sAC, [';']);
              sLineText := GetValidStr3(sLineText, sMAC, [';']);
              sLineText := GetValidStr3(sLineText, sDC, [';']);
              sLineText := GetValidStr3(sLineText, sDCMAX, [';']);
              sLineText := GetValidStr3(sLineText, sMC, [';']);
              sLineText := GetValidStr3(sLineText, sSC, [';']);
              sLineText := GetValidStr3(sLineText, sSPEED, [';']);
              sLineText := GetValidStr3(sLineText, sHIT, [';']);
              sLineText := GetValidStr3(sLineText, sWALK_SPD, [';']);
              sLineText := GetValidStr3(sLineText, sWalkStep, [';']);
              sLineText := GetValidStr3(sLineText, sWalkWait, [';']);
              sLineText := GetValidStr3(sLineText, sATTACK_SPD, [';']);

              if sName <> '' then begin
                with FrmDM.TableMonster do begin//Ð´ÈëÊý¾Ý¿â
                  Append;
                  FieldByName('Name').AsString:= sName;
                  FieldByName('Race').AsInteger:= Str_ToInt( sRace, 0);
                  FieldByName('RaceImg').AsInteger:= Str_ToInt( sRaceImg, 0);
                  FieldByName('Appr').AsInteger:= Str_ToInt( sAppr, 0);
                  FieldByName('Lvl').AsInteger:= Str_ToInt( sLvl, 0);
                  FieldByName('Undead').AsInteger:= Str_ToInt( sUndead, 0);
                  FieldByName('CoolEye').AsInteger:= Str_ToInt( sCoolEye, 0);
                  FieldByName('Exp').AsInteger:= Str_ToInt( sExp, 0);
                  FieldByName('HP').AsInteger:= Str_ToInt( sHP, 0);
                  FieldByName('MP').AsInteger:= Str_ToInt( sMP, 0);
                  FieldByName('AC').AsInteger:= Str_ToInt( sAC, 0);
                  FieldByName('MAC').AsInteger:= Str_ToInt( sMAC, 0);
                  FieldByName('DC').AsInteger:= Str_ToInt( sDC, 0);
                  FieldByName('DCMAX').AsInteger:= Str_ToInt( sDCMAX, 0);
                  FieldByName('MC').AsInteger:= Str_ToInt( sMC, 0);
                  FieldByName('SC').AsInteger:= Str_ToInt( sSC, 0);
                  FieldByName('SPEED').AsInteger:= Str_ToInt( sSPEED, 0);
                  FieldByName('HIT').AsInteger:= Str_ToInt( sHIT, 0);
                  FieldByName('WALK_SPD').AsInteger:= Str_ToInt( sWALK_SPD, 0);
                  FieldByName('WalkStep').AsInteger:= Str_ToInt( sWalkStep, 0);
                  FieldByName('WalkWait').AsInteger:= Str_ToInt( sWalkWait, 0);
                  FieldByName('ATTACK_SPD').AsInteger:= Str_ToInt( sATTACK_SPD, 0);
                  post;
                  Application.ProcessMessages;//³öÈÃ¿ØÖÆÈ¨£¬ÈÃwindows×öÆäËüÊÂ
                end;
              end;
            end;
          end;
        finally
          LoadList.Free;
        end;
      end;
    end;
  end;
end;

procedure TFrmMain.bsSkinButton5Click(Sender: TObject);
var
  LoadList:TStringList;
  sLineText:String;
  sMagId,sMagName,sEffectType,sEffect,sSpell,sPower,sMaxPower,sJob: string;
  sNeedL1,sNeedL2,sNeedL3,sL1Train,sL2Train,sL3Train,sDelay,sDefSpell,sDefPower,sDefMaxPower,sDescr: string;
  I:integer;
begin
  OpenDialog1.Filter := 'TextÎÄ¼þ(*.txt)|*.txt';
  with OpenDialog1 do begin
    if Execute then begin
      if FileExists(FileName) then begin
        LoadList:=TStringList.Create;
        LoadList.LoadFromFile(FileName);
        try
          for I := 0 to LoadList.Count - 1 do begin
            sLineText:= Trim(LoadList.Strings[I]);
            if (sLineText <> '') and (sLineText[1] <> ';') then begin
              sLineText := GetValidStr3(sLineText, sMagId, [';']);
              sLineText := GetValidStr3(sLineText, sMagName, [';']);
              sLineText := GetValidStr3(sLineText, sEffectType, [';']);
              sLineText := GetValidStr3(sLineText, sEffect, [';']);
              sLineText := GetValidStr3(sLineText, sSpell, [';']);
              sLineText := GetValidStr3(sLineText, sPower, [';']);
              sLineText := GetValidStr3(sLineText, sMaxPower, [';']);
              sLineText := GetValidStr3(sLineText, sDefSpell, [';']);
              sLineText := GetValidStr3(sLineText, sDefPower, [';']);
              sLineText := GetValidStr3(sLineText, sDefMaxPower, [';']);
              sLineText := GetValidStr3(sLineText, sJob, [';']);
              sLineText := GetValidStr3(sLineText, sNeedL1, [';']);
              sLineText := GetValidStr3(sLineText, sL1Train, [';']);
              sLineText := GetValidStr3(sLineText, sNeedL2, [';']);
              sLineText := GetValidStr3(sLineText, sL2Train, [';']);
              sLineText := GetValidStr3(sLineText, sNeedL3, [';']);
              sLineText := GetValidStr3(sLineText, sL3Train, [';']);
              sLineText := GetValidStr3(sLineText, sDelay, [';']);
              sLineText := GetValidStr3(sLineText, sDescr, [';']);

              if sMagName <> '' then begin
                with FrmDM.TableMagic do begin//Ð´ÈëÊý¾Ý¿â
                  Append;
                  FieldByName('MagId').AsInteger:= Str_ToInt( sMagId, 0);
                  FieldByName('MagName').AsString:= sMagName;
                  FieldByName('EffectType').AsInteger:= Str_ToInt( sEffectType, 0);
                  FieldByName('Effect').AsInteger:= Str_ToInt( sEffect, 0);
                  FieldByName('Spell').AsInteger:= Str_ToInt( sSpell, 0);
                  FieldByName('Power').AsInteger:= Str_ToInt( sPower, 0);
                  FieldByName('MaxPower').AsInteger:= Str_ToInt( sMaxPower, 0);


                  FieldByName('Job').AsInteger:= Str_ToInt( sJob, 0);
                  FieldByName('NeedL1').AsInteger:= Str_ToInt( sNeedL1, 0);
                  FieldByName('NeedL2').AsInteger:= Str_ToInt( sNeedL2, 0);
                  FieldByName('NeedL3').AsInteger:= Str_ToInt( sNeedL3, 0);
                  FieldByName('L1Train').AsInteger:= Str_ToInt( sL1Train, 0);
                  FieldByName('L2Train').AsInteger:= Str_ToInt( sL2Train, 0);
                  FieldByName('L3Train').AsInteger:= Str_ToInt( sL3Train, 0);
                  FieldByName('Delay').AsInteger:= Str_ToInt( sDelay, 0);
                  FieldByName('DefSpell').AsInteger:= Str_ToInt( sDefSpell, 0);
                  FieldByName('DefPower').AsInteger:= Str_ToInt( sDefPower, 0);
                  FieldByName('DefMaxPower').AsInteger:= Str_ToInt( sDefMaxPower, 0);
                  FieldByName('Descr').AsString:= sDescr;
                  post;
                  Application.ProcessMessages;//³öÈÃ¿ØÖÆÈ¨£¬ÈÃwindows×öÆäËüÊÂ
                end;
              end;
            end;
          end;
        finally
          LoadList.Free;
        end;
      end;
    end;
  end;
end;

procedure TFrmMain.bsSkinButton6Click(Sender: TObject);
  function GetParadoxConnectionString(Path: string; Password: string): string;
  var
    s: string;
  begin
    s := 'Provider=Microsoft.Jet.OLEDB.4.0;';
    s := s + 'Data Source=' + Path + ';';
    s := s + 'Extended Properties=Paradox 7.x;Persist Security Info=False;';
    s := s + 'Mode=Share Deny None;';
    if Password <> '' then
      s := s + 'Jet OLEDB:Database Password=' + Password;
    Result := s;
  end;
var
  DestTable:TTable;
  KK: TFieldDef;
begin
  DestTable:= TTable.Create(Application);
  try
    FrmDM.TableMagic.Open;
    with DestTable do begin
      FieldDefs.Assign(FrmDM.TableMagic.FieldDefs);//¸´ÖÆ±í½á¹¹
      DataBaseName:= bsSkinFileEdit3.text;//±£´æÂ·¾¶
      KK:= FieldDefs.Find('MagName');
      KK.DataType:= ftString;//ÐÞ¸ÄMagNameÎªstringÀàÐÍ
      KK.Size:= 18;//À©Õ¹ÊýÁ¿
      TableName:='NewMagic';//Êý¾Ý¿âÃû
      TableType:=ttParadox;//Êý¾Ý¿âÀàÐÍ
      CreateTable;//´´½¨ÐÂµÄÊý¾Ý±í
    end;

    DestTable.Open;
    FrmDM.Query1.DataBaseName:=DBEName;
    with FrmDM.Query1 do begin
      close;
      sql.Clear ;
      sql.add('select * from Magic order by Descr,MagId DESC');
      open;
      First;
      while not FrmDM.Query1.Eof do begin
        with DestTable do begin
          Insert;
          FieldByName('MagId').AsInteger := FrmDM.Query1.FieldByName('MagId').AsInteger;
          FieldByName('MagName').AsString := FrmDM.Query1.FieldByName('MagName').AsString;
          FieldByName('EffectType').AsInteger := FrmDM.Query1.FieldByName('EffectType').AsInteger;
          FieldByName('Effect').AsInteger := FrmDM.Query1.FieldByName('Effect').AsInteger;
          FieldByName('Spell').AsInteger := FrmDM.Query1.FieldByName('Spell').AsInteger;
          FieldByName('Power').AsInteger := FrmDM.Query1.FieldByName('Power').AsInteger;
          FieldByName('MaxPower').AsInteger := FrmDM.Query1.FieldByName('MaxPower').AsInteger;
          FieldByName('DefSpell').AsInteger := FrmDM.Query1.FieldByName('DefSpell').AsInteger;
          FieldByName('DefPower').AsInteger := FrmDM.Query1.FieldByName('DefPower').AsInteger;
          FieldByName('DefMaxPower').AsInteger := FrmDM.Query1.FieldByName('DefMaxPower').AsInteger;
          FieldByName('Job').AsInteger := FrmDM.Query1.FieldByName('Job').AsInteger;
          FieldByName('NeedL1').AsInteger := FrmDM.Query1.FieldByName('NeedL1').AsInteger;
          FieldByName('L1Train').AsInteger := FrmDM.Query1.FieldByName('L1Train').AsInteger;
          FieldByName('NeedL2').AsInteger := FrmDM.Query1.FieldByName('NeedL2').AsInteger;
          FieldByName('L2Train').AsInteger := FrmDM.Query1.FieldByName('L2Train').AsInteger;
          FieldByName('NeedL3').AsInteger := FrmDM.Query1.FieldByName('NeedL3').AsInteger;
          FieldByName('L3Train').AsInteger := FrmDM.Query1.FieldByName('L3Train').AsInteger;
          FieldByName('Delay').AsInteger := FrmDM.Query1.FieldByName('Delay').AsInteger;
          FieldByName('Descr').AsString := FrmDM.Query1.FieldByName('Descr').AsString;
          post;
        end;
        FrmDM.Query1.Next;
      end;
    end;
  finally
    DestTable.Free;
  end;
  bsSkinMessage1.MessageDlg('Êý¾Ý¿âÀ©Õ¹Íê³É£¡'+bsSkinFileEdit3.text+'\NewMagic.DB',mtInformation,[mbOK],0);
end;

procedure TFrmMain.bsSkinFileEdit3ButtonClick(Sender: TObject);
begin
  if bsSkinSelectDirectoryDialog1.Execute then begin
    bsSkinFileEdit3.Text:= bsSkinSelectDirectoryDialog1.Directory;
    if bsSkinFileEdit3.Text <> '' then bsSkinButton6.Enabled:= True;
  end;
end;

end.
